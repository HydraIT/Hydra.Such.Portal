
@{
    ViewData["Title"] = "DiarioCafeterias";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1 class="title">Diário de Cafetarias</h1>

<link rel="import" href="/lib/vaadin-grid/vaadin-grid.html" />
<link rel="import" href="/lib/vaadin-grid/vaadin-grid-sorter.html" />
<link rel="import" href="/lib/vaadin-grid/vaadin-grid-sort-behavior.html" />
<link rel="import" href="/lib/vaadin-grid/vaadin-grid-filter.html" />
<link rel="import" href="/lib/vaadin-grid/vaadin-grid-filter-behavior.html" />

<link rel="import" href="~/lib/vaadin-valo-theme/vaadin-text-field.html">
<link rel="import" href="~/lib/vaadin-text-field/vaadin-text-field.html">

<link rel="import" href="/lib/vaadin-date-picker/vaadin-date-picker.html">
<link rel="import" href="/lib/vaadin-valo-theme/vaadin-date-picker.html">

<link rel="import" href="/lib/vaadin-valo-theme/vaadin-combo-box.html" />
<link rel="import" href="/lib/vaadin-combo-box/vaadin-combo-box.html" />
<link rel="import" href="/lib/vaadin-combo-box/vaadin-combo-box-behavior.html" />

<x-coffeeshopdiary></x-coffeeshopdiary>

<dom-module id="x-coffeeshopdiary">
    <template>
        <link rel="stylesheet" href="/lib/bootstrap/dist/css/bootstrap.css" />
        <link rel="stylesheet" href="/css/main.css" />

        <custom-style>
            <style is="custom-style">
                input[readonly] {
                    border: 2px solid transparent;
                }

                input {
                    font: inherit;
                }

                .grid {
                    font-size: 13px;
                }

                    .grid input {
                        border: none;
                        padding-left: 5px;
                    }

                paper-input {
                    max-width: 200px !important;
                }
            </style>
        </custom-style>

        <iron-ajax url="/Nutricao/GetCoffeShopDiary"
                   last-response="{{result}}"
                   method="post"
                   handle-as="json"
                   id="grid_databound_ajax"
                   content-type="application/json"></iron-ajax>

        <iron-ajax url="/PopulateDropdowns/GetTiposMovimento" last-response="{{CBMovementType}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>


        <div class="row">
            <div class="col-lg-2">
                <vaadin-text-field id="produtiveUnityNo" name="produtiveUnityNo" value="{{result.produtiveUnityNo}}" label="Unidade Produtiva" disabled></vaadin-text-field>
            </div>
            <div class="col-lg-2">
                <vaadin-text-field id="coffeShopCode" name="coffeShopCode" value="{{result.coffeShopCode}}" label="Codigo Cafetaria/Ref" disabled></vaadin-text-field>
            </div>
            <div class="col-lg-2">
                <vaadin-date-picker label="Data Registo" id="registryDate" name="registryDate"></vaadin-date-picker>
            </div>
            <div class="col-lg-2">
                <vaadin-combo-box items="[[CBMovementType]]" id="cbmovementType" item-value-path="id" item-label-path="value" value="{{data.movementType}}" label="Tipo de Movimento">
                    <template>
                        <paper-icon-item>
                            <paper-item-body two-line>
                                <div>[[item.value]]</div>
                            </paper-item-body>
                        </paper-icon-item>
                    </template>
                </vaadin-combo-box>
            </div>
            <div class="col-lg-2">
                <vaadin-text-field id="description" name="description" value="{{ddDescription}}" label="Descrição"></vaadin-text-field>
            </div>
            <div class="col-lg-2">
                <vaadin-text-field id="Value" name="Value" value="{{ddValue}}" pattern="^[1-9]\d*(\.\d+)?$" error-message="Valor inválido" label="Valor"></vaadin-text-field>
            </div>
            
        </div>
        <br />
        <div class="row">
            <div class="col-lg-1">
                <paper-button class="btnSave" on-tap="_createCoffeeShopDiary">Criar</paper-button>
            </div>
        </div>
        <br />
        <vaadin-grid aria-label="ContractsGrid" items="[[result]]" class="grid" active-item="{{activeItem}}" multi-sort="true">
            <vaadin-grid-column width="120px">
                <template class="header">
                    <vaadin-grid-sorter path="produtiveUnityNo">Unidade Produtiva</vaadin-grid-sorter>
                    <vaadin-grid-filter path="produtiveUnityNo" />
                </template>
                <template>
                    {{item.produtiveUnityNo}}
                </template>
            </vaadin-grid-column>
            <vaadin-grid-column width="110px">
                <template class="header">
                    <vaadin-grid-sorter path="coffeShopCode">Código Cafetaria/Ref	</vaadin-grid-sorter>
                    <vaadin-grid-filter path="coffeShopCode" />
                </template>
                <template>
                    {{item.coffeShopCode}}
                </template>
            </vaadin-grid-column>
            <vaadin-grid-column width="110px">
                <template class="header">
                    <vaadin-grid-sorter path="registryDate">Data Registo</vaadin-grid-sorter>
                    <vaadin-grid-filter path="registryDate" />
                </template>
                <template>
                    {{item.registryDate}}
                </template>
            </vaadin-grid-column>
            <vaadin-grid-column width="200px">
                <template class="header">
                    <vaadin-grid-sorter path="movementType">Tipo Movimento</vaadin-grid-sorter>
                    <vaadin-grid-filter path="movementType" />
                </template>
                <template>
                    {{item.movementType}}
                </template>
            </vaadin-grid-column>
            <vaadin-grid-column width="200px">
                <template class="header">
                    <vaadin-grid-sorter path="description">Descrição</vaadin-grid-sorter>
                    <vaadin-grid-filter path="description" />
                </template>
                <template>
                    {{item.description}}
                </template>
            </vaadin-grid-column>
            <vaadin-grid-column width="110px">
                <template class="header">
                    <vaadin-grid-sorter path="value">Valor</vaadin-grid-sorter>
                    <vaadin-grid-filter path="value" />
                </template>
                <template>
                    {{item.value}}
                </template>
            </vaadin-grid-column>
            <vaadin-grid-column width="10%" resizable>
                <template class="header">
                </template>
                <template>
                    <center>
                        <paper-button class="btnRemove" raised on-tap="_deleteOprotunity" disabled="{{_permissionsDelete}}">Eliminar</paper-button>
                    </center>
                </template>
            </vaadin-grid-column>
        </vaadin-grid>

        <paper-toast id="ToastMessage" duration="4000" horizontalAlign="right" class="toastSuccess">&nbsp;<i class="fa fa-check fa-lg" aria-hidden="true"></i></paper-toast>
        <paper-toast id="ToastError" duration="4000" horizontalAlign="right" class="toastError">&nbsp;<i class="fa fa-exclamation-triangle" aria-hidden="true"></i></paper-toast>
    </template>

<script>
    @*var CreateValue = true, UpdateValue = true, DeleteValue = true;
    if ('@Html.Raw(Json.Serialize(ViewBag.CreatePermissions))' =="false") {
    CreateValue = false;
    }
    if ('@Html.Raw(Json.Serialize(ViewBag.UpdatePermissions))' =="false") {
    UpdateValue = false;
    }
    if ('@Html.Raw(Json.Serialize(ViewBag.DeletePermissions))' =="false") {
    DeleteValue = false;
    }*@
    document.addEventListener('WebComponentsReady', function () {
    Polymer({
        is: 'x-coffeeshopdiary'
        //properties: {
        //_permissionsUpdate: {
        //type: Boolean,
        //value: UpdateValue
        //},
        //_permissionsCreate: {
        //type: Boolean,
        //value: CreateValue
        //},
        //_permissionsDelete: {
        //type: Boolean,
        //value: DeleteValue
        //},
    //ddClients: {
    //type: Number,
    //notify: true,
    //value: ""
    //},

    //ddServices: {
    //type: Number,
    //notify: true,
    //value: ""
    //},
    //_filterActive: {
    //type: Boolean,
    //value: true
    //}
    //},
    //    openToast: function (message) {
    //    this.$.ToastMessageSuccess.text = message;
    //    this.$.ToastMessageSuccess.open();
    //    },
    //    openToastError: function (message) {
    //    this.$.ToastError.text = message;
    //    this.$.ToastError.open();
    //    },
    //    _update: function () {

    //    this.$.page_update_ajax.body = JSON.stringify(this.result);
    //    this.$.page_update_ajax.generateRequest();
    //    this.$.gridClientServices.clearCache();
    //    },
    //    _CreateResponse: function (e) {
    //    var self = this;
    //    if (this.exist === false) {
    //    this.openToast('Criado com sucesso');
    //    this.ddClients = "";
    //    this.ddServices = "";
    //    this.chkServiceGroup = false;

    //    this.$.page_databound_ajax.generateRequest();
    //    }
    //    else if (this.exist === true) {

    //    this.openToastError("Este serviço cliente já existe.");
    //    this.$.page_databound_ajax.generateRequest();
    //    } else {
    //    this.openToastError('Ocorreu um erro ao Criar o Serviço Cliente.');
    //    }
    //    },
    //    _UpdateResponse: function (e) {
    //    var self = this;
    //    if (e.detail.status === 200) {
    //    this.openToast('Atualizado com sucesso');
    //    this.$.page_databound_ajax.generateRequest();
    //    }
    //    else {
    //    this.openToastError('Ocorreu um erro ao atualizar o Serviço Cliente.');
    //    }
    //    },

    //    _DeleteResponse: function (e) {
    //    var self = this;
    //    if (e.detail.status === 200) {
    //    this.openToast('Eliminado com sucesso');
    //    this.$.page_databound_ajax.generateRequest();
    //    }
    //    else {
    //    this.openToastError('Ocorreu um erro ao atualizar o Serviço Cliente.');
    //    }
    //    },

    //    _cancel: function () {
    //    this.$.page_databound_ajax.generateRequest();
    //    this.$.gridClientServices.clearCache();
    //    },

    //    _createClientService: function () {

    //    if (this.ddClients != "" && this.ddServices != "") {
    //    if (this.result == null)
    //    {
    //    this.result.unshift({
    //    ClientNumber: this.ddClients,
    //    ServiceCode: this.ddServices,
    //    ServiceGroup: this.chkServiceGroup
    //    });
    //    }
    //    else
    //    {
    //    this.result.unshift({
    //    ClientNumber: this.ddClients,
    //    ServiceCode: this.ddServices,
    //    ServiceGroup: this.chkServiceGroup
    //    });
    //    }
    //    this.$.page_create_ajax.body = JSON.stringify(this.result);
    //    this.$.page_create_ajax.generateRequest();
    //    this.$.gridClientServices.clearCache();
    //    } else {
    //    this.openToastError('Preencha os campos antes de criar.');

    //    }
    //    },

    //    _deleteAccessProfile: function (data) {
    //    var index = this.result.indexOf(data.model.item);
    //    this.result.splice(index, 1);
    //    this.$.page_delete_ajax.body = JSON.stringify(this.result);
    //    this.$.page_delete_ajax.generateRequest();
    //    this.$.gridClientServices.clearCache();
    //    }

        });
    });
</script>
</dom-module>
