<link rel="import" href="/lib/paper-button/paper-button.html" />
<link rel="import" href="/lib/paper-checkbox-master/paper-checkbox.html" />
<link rel="import" href="/lib/paper-dialog/paper-dialog.html" />
<link rel="import" href="/lib/paper-dialog-behavior/paper-dialog-behavior.html" />
<link rel="import" href="/lib/paper-input/paper-input.html" />
<link rel="import" href="/lib/paper-tabs-master/paper-tab.html" />
<link rel="import" href="/lib/paper-tabs-master/paper-tabs.html" />
<link rel="import" href="/lib/paper-toast-master/paper-toast.html" />
<link rel="import" href="/lib/paper-tooltip-master/paper-tooltip.html">

<link rel="import" href="/lib/iron-form/iron-form.html" />
<link rel="import" href="/lib/iron-menu-behavior/iron-menubar-behavior.html" />
<link rel="import" href="/lib/iron-pages-master/iron-pages.html" />

<link rel="import" href="/lib/vaadin-checkbox/vaadin-checkbox.html">
<link rel="import" href="/lib/vaadin-combo-box/vaadin-combo-box.html" />
<link rel="import" href="/lib/vaadin-context-menu/vaadin-context-menu.html" />
<link rel="import" href="/lib/vaadin-date-picker/vaadin-date-picker.html">
<link rel="import" href="/lib/vaadin-grid/vaadin-grid.html">
<link rel="import" href="/lib/vaadin-grid/vaadin-grid-sorter.html" />
<link rel="import" href="/lib/vaadin-grid/vaadin-grid-sort-behavior.html" />
<link rel="import" href="/lib/vaadin-grid/vaadin-grid-filter.html" />
<link rel="import" href="/lib/vaadin-grid/vaadin-grid-filter-behavior.html" />
<link rel="import" href="/lib/vaadin-item/vaadin-item.html" />
<link rel="import" href="/lib/vaadin-list-box/vaadin-list-box.html" />
<link rel="import" href="/lib/vaadin-radio-button/vaadin-radio-button.html">
<link rel="import" href="/lib/vaadin-radio-button/vaadin-radio-button-group.html">
<link rel="import" href="/lib/vaadin-text-field/vaadin-text-field.html">
<link rel="import" href="/lib/vaadin-themable-mixin/vaadin-themable-mixin.html" />
<link rel="import" href="/lib/vaadin-valo-theme/vaadin-date-picker.html">
<link rel="import" href="/lib/vaadin-valo-theme/vaadin-checkbox.html">

<link rel="import" href="/lib/neon-animation/web-animations.html">

<!--ACORDEÃO-->
<link rel="import" href="/lib/paper-collapse-item/paper-collapse-group.html">
<link rel="import" href="/lib/paper-collapse-item/paper-collapse-item.html">

<!--SUCH-->
<link rel="import" href="/lib/such-selectbox/such-selectbox.html">
<link rel="import" href="/lib/such-textarea/such-textarea.html">

<h1 class="title">Folha de Horas</h1>

<dom-module id="x-folhadehoradetails">
    <template>
        <!-- STYLES -->
        <link rel="stylesheet" href="/lib/bootstrap/dist/css/bootstrap.css" />
        <link rel="stylesheet" href="/lib/font-awesome-4.7.0/css/font-awesome.min.css" />
        <link rel="stylesheet" href="/css/main.css" />

        <style>
            vaadin-combo-box {
                margin-top: 0px !important;
                width: 100% !important;
            }

            vaadin-date-picker {
                margin-top: 0px !important;
                width: 100% !important;
            }

            vaadin-text-field {
                margin-top: 0px !important;
                width: 100%;
            }

            .label_custom {
                color: var(--valo-contrast-60pct) !important;
                font-weight: 500 !important;
                font-size: var(--valo-font-size-s) !important;
                margin-left: calc(var(--valo-text-field-border-radius, var(--valo-border-radius)) / 4) !important;
                margin-bottom: var(--valo-space-xs) !important;
                transition: color 0.4s !important;
                line-height: 1 !important;
                font-family: var(--valo-font-family) !important;
            }

            .break_clear {
                margin-top: 15px;
            }

            .btn--confirm {
                min-width: 50px !important;
                height: 30px !important;
                padding: 5px 10px;
                cursor: pointer;
                background: #71BCC1;
                color: white;
                margin-top: 7px;
            }

            vaadin-grid.disabled:after {
                content: "";
                position: absolute;
                left: 0;
                right: 0;
                top: 0;
                bottom: 0;
                width: 100%;
                cursor: not-allowed;
            }

            paper-button.disabled {
                cursor: not-allowed;
                pointer-events: none;
            }

            /*ACORDEÃO*/
            paper-collapse-item {
                --paper-item: {
                    padding: 0 0;
                };
                --paper-collapse-item-header: {
                    padding: 0 15px;
                    color: #333;
                    background-color: #f5f5f5;
                    border-bottom: solid #ddd 1px;
                    border-top-left-radius: 3px;
                    border-top-right-radius: 3px;

                };
            }

            .panel-body {
                padding-top: 0px !important;
            }

            /*vaadin-text-field.disabled:after {
                background: #ff0000;
            }*/
        </style>

        <!-- DROPDOWNS POPULATE -->
        <iron-ajax url="/PopulateDropdowns/GetEmployees_FH" last-response="{{LFolhaDeHoraEmployees}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetRegionCode" last-response="{{LFolhaDeHoraRegionCodes}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetFunctionalAreaCode" last-response="{{LFolhaDeHoraFunctionalAreaCodes}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetResponsabilityCenterCode" last-response="{{LFolhaDeHoraResponsabilityCenterCodes}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetFolhaDeHoraStatus" last-response="{{LFolhaDeHoraStatus}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetFolhaDeHoraTypeDeslocation" last-response="{{LFolhaDeHoraTypeDeslocation}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetFolhaDeHoraCodeTypeKms" last-response="{{LFolhaDeHoraCodeTypeKms}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetProjectList" last-response="{{LFolhaDeHoraProjectNo}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetProjectNavList" last-response="{{LFolhaDeHoraNavProjectNo}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetTipoTrabalhoList" last-response="{{LFolhaDeHoraTipoTrabalhoNo}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetFolhaDeHoraDisplacementOutsideCity" last-response="{{LFolhaDeHoraDisplacementOutsideCity}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetUtilizadores" last-response="{{LFolhaDeHoraValidators}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetFolhaDeHoraPercursoOrigemDestino" last-response="{{LFolhaDeHoraPercursoOrigemDestino}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetFolhaDeHoraViaturasMatriculas" last-response="{{LFolhaDeHoraViaturaMatricula}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetRHRecursosFH" last-response="{{LFolhaDeHoraGetRHRecursosFH}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetFolhaDeHoraAjudaTipoCusto" last-response="{{LFolhaDeHoraAjudaTipoCusto}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetCodTipoCustoByTipoCusto" last-response="{{LFolhaDeHoraAjudaCodTipoCusto}}" method="post" handle-as="json" id="get_codtipocusto" on-response="_setCodTipoCustoResponse" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetFolhaDeHoraAjudaTipoCusto" last-response="{{LFolhaDeHoraAjudaTipoCusto_TAB}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>
        <iron-ajax url="/PopulateDropdowns/GetCodTipoCustoByTipoCusto_ALL" last-response="{{LFolhaDeHoraAjudaCodTipoCusto_ALL}}" auto method="post" handle-as="json" content-type="application/json"></iron-ajax>

        <!-- FOLHADEHORA CRUDS -->
        <iron-ajax url="/FolhasDeHoras/GetFolhaDeHoraDetails"
                   last-response="{{data}}"
                   method="post"
                   handle-as="json"
                   id="page_databound_ajax"
                   on-response="_responseProcessor"
                   content-type="application/json">
        </iron-ajax>

        <iron-ajax url="/FolhasDeHoras/ValidarDataHoraInicio_DataHoraFim"
                   last-response="{{FolhaDeHorasUpdatedValidacao}}"
                   method="post"
                   handle-as="json"
                   id="page_updatefolhadehorasvalidacao_ajax"
                   on-response="_updatefolhadehorasvalidacaoResponse"
                   content-type="application/json">
        </iron-ajax>

        <!--<iron-ajax url="/FolhasDeHoras/UpdateFolhaDeHorasValidacao"
                   last-response="{{FolhaDeHorasUpdatedValidacao}}"
                   method="post"
                   handle-as="json"
                   id="page_updatefolhadehorasvalidacao_ajax"
                   on-response="_updatefolhadehorasvalidacaoResponse"
                   content-type="application/json">
        </iron-ajax>-->

        <iron-ajax url="/FolhasDeHoras/UpdateFolhaDeHoras"
                   last-response="{{FolhaDeHorasUpdated}}"
                   method="post"
                   handle-as="json"
                   id="page_updatefolhadehoras_ajax"
                   on-response="_updatefolhadehorasResponse"
                   content-type="application/json">
        </iron-ajax>

        <iron-ajax url="/FolhasDeHoras/GetEmployeeNome"
                   last-response="{{getEmpoyeeNAV}}"
                   method="post"
                   handle-as="json"
                   id="getEmpoyeeNAV_ajax"
                   on-response="_getEmpoyeeNAVResponse"
                   content-type="application/json">
        </iron-ajax>

        <iron-ajax url="/FolhasDeHoras/ValidarDataHoraInicio_DataHoraFim"
                   last-response="{{validarDataHoraInicio_DataHoraFim}}"
                   method="post"
                   handle-as="json"
                   id="validarDataHoraInicio_DataHoraFim_ajax"
                   on-response="_validarDataHoraInicio_DataHoraFimResponse"
                   content-type="application/json">
        </iron-ajax>

        <!--<iron-ajax url="/FolhasDeHoras/ValidateNumeration"
                   last-response="{{validateResponse}}"
                   method="post"
                   handle-as="json"
                   id="page_validator_ajax"
                   on-response="_responseValidatorProcessor"
                   content-type="application/json">
        </iron-ajax>-->
        <!--PERCURSO-->
        <iron-ajax url="/FolhasDeHoras/CreatePercurso"
                   last-response="{{PercursoCreated}}"
                   method="post"
                   handle-as="json"
                   id="page_createpercurso_ajax"
                   on-response="_createPercursoResponse"
                   content-type="application/json">
        </iron-ajax>

        <iron-ajax url="/FolhasDeHoras/DeletePercurso"
                   last-response="{{PercursoDeleted}}"
                   method="post"
                   handle-as="json"
                   id="page_deletepercurso_ajax"
                   on-response="_deletePercursoResponse"
                   content-type="application/json">
        </iron-ajax>

        <!--<iron-ajax url="/FolhasDeHoras/UpdatePercurso"
                   last-response="{{PercursoUpdated}}"
                   method="post"
                   handle-as="json"
                   id="page_updatepercurso_ajax"
                   on-response="_updatePercursoResponse"
                   content-type="application/json">
        </iron-ajax>-->

        <iron-ajax url="/FolhasDeHoras/UpdateLinhaPercurso"
                   last-response="{{LinhaPercursoUpdated}}"
                   method="post"
                   handle-as="json"
                   id="page_updatelinhapercurso_ajax"
                   on-response="_updateLinhaPercursoResponse"
                   content-type="application/json">
        </iron-ajax>


        <!--AJUDA-->
        <iron-ajax url="/FolhasDeHoras/CreateAjuda"
                   last-response="{{AjudaCreated}}"
                   method="post"
                   handle-as="json"
                   id="page_createajuda_ajax"
                   on-response="_createAjudaResponse"
                   content-type="application/json">
        </iron-ajax>

        <iron-ajax url="/FolhasDeHoras/DeleteAjuda"
                   last-response="{{AjudaDeleted}}"
                   method="post"
                   handle-as="json"
                   id="page_deleteajuda_ajax"
                   on-response="_deleteAjudaResponse"
                   content-type="application/json">
        </iron-ajax>

        <!--<iron-ajax url="/FolhasDeHoras/UpdateAjuda"
                   last-response="{{AjudaUpdated}}"
                   method="post"
                   handle-as="json"
                   id="page_updateajuda_ajax"
                   on-response="_updateAjudaResponse"
                   content-type="application/json">
        </iron-ajax>-->

        <iron-ajax url="/FolhasDeHoras/UpdateLinhaAjuda"
                   last-response="{{LinhaAjudaUpdated}}"
                   method="post"
                   handle-as="json"
                   id="page_updatelinhaajuda_ajax"
                   on-response="_updateLinhaAjudaResponse"
                   content-type="application/json">
        </iron-ajax>

        <!--MAODEOBRA-->
        <iron-ajax url="/FolhasDeHoras/CreateMaoDeObra"
                   last-response="{{MaoDeObraCreated}}"
                   method="post"
                   handle-as="json"
                   id="page_createmaodeobra_ajax"
                   on-response="_createMaoDeObraResponse"
                   content-type="application/json">
        </iron-ajax>

        <iron-ajax url="/FolhasDeHoras/DeleteMaoDeObra"
                   last-response="{{MaoDeObraDeleted}}"
                   method="post"
                   handle-as="json"
                   id="page_deletemaodeobra_ajax"
                   on-response="_deleteMaoDeObraResponse"
                   content-type="application/json">
        </iron-ajax>

        <!--<iron-ajax url="/FolhasDeHoras/UpdateMaoDeObra"
                   last-response="{{MaoDeObraUpdated}}"
                   method="post"
                   handle-as="json"
                   id="page_updatemaodeobra_ajax"
                   on-response="_updateMaoDeObraResponse"
                   content-type="application/json">
        </iron-ajax>-->

        <iron-ajax url="/FolhasDeHoras/UpdateLinhaMaoDeObra"
                   last-response="{{LinhaMaoDeObraUpdated}}"
                   method="post"
                   handle-as="json"
                   id="page_updatelinhamaodeobra_ajax"
                   on-response="_updateLinhaMaoDeObraResponse"
                   content-type="application/json">
        </iron-ajax>

        <iron-ajax url="/FolhasDeHoras/MaoDeObraHoraInicioFim"
                   last-response="{{MaoDeObraHoraInicioFim}}"
                   method="post"
                   handle-as="json"
                   id="page_maodeobrahorainiciofim_ajax"
                   on-response="_MaoDeObraHoraInicioFimResponse"
                   content-type="application/json">
        </iron-ajax>

        <!--PRESENCA-->
        <iron-ajax url="/FolhasDeHoras/CreatePresenca"
                   last-response="{{PresencaCreated}}"
                   method="post"
                   handle-as="json"
                   id="page_createpresenca_ajax"
                   on-response="_createPresencaResponse"
                   content-type="application/json">
        </iron-ajax>

        <iron-ajax url="/FolhasDeHoras/DeletePresenca"
                   last-response="{{PresencaDeleted}}"
                   method="post"
                   handle-as="json"
                   id="page_deletepresenca_ajax"
                   on-response="_deletePresencaResponse"
                   content-type="application/json">
        </iron-ajax>

        <!--<iron-ajax url="/FolhasDeHoras/UpdatePresenca"
                   last-response="{{PresencaUpdated}}"
                   method="post"
                   handle-as="json"
                   id="page_updatepresenca_ajax"
                   on-response="_updatePresencaResponse"
                   content-type="application/json">
        </iron-ajax>-->

        <iron-ajax url="/FolhasDeHoras/UpdateLinhaPresenca"
                   last-response="{{LinhaPresencaUpdated}}"
                   method="post"
                   handle-as="json"
                   id="page_updatelinhapresenca_ajax"
                   on-response="_updateLinhaPresencaResponse"
                   content-type="application/json">
        </iron-ajax>

        <!--BOTÕES-->
        <iron-ajax url="/FolhasDeHoras/CalcularAjudasCusto"
                   last-response="{{CalcularAjudasCustoUpdated}}"
                   method="post"
                   handle-as="json"
                   id="page_calcularajudascusto_ajax"
                   on-response="_updateCalcularAjudasCustoResponse"
                   content-type="application/json">
        </iron-ajax>

        <iron-ajax url="/FolhasDeHoras/TerminarFolhaDeHoras"
                   last-response="{{terminarFolhaDeHoras}}"
                   method="post"
                   handle-as="json"
                   id="terminarfolhadehoras_ajax"
                   on-response="_terminarfolhadehorasResponse"
                   content-type="application/json">
        </iron-ajax>

        <iron-ajax url="/FolhasDeHoras/ValidarFolhaDeHoras"
                   last-response="{{validarFolhaDeHoras}}"
                   method="post"
                   handle-as="json"
                   id="validarfolhadehoras_ajax"
                   on-response="_validarfolhadehorasResponse"
                   content-type="application/json">
        </iron-ajax>

        <iron-ajax url="/FolhasDeHoras/IntegrarEmRHFolhaDeHoras"
                   last-response="{{integrarEmRHFolhaDeHoras}}"
                   method="post"
                   handle-as="json"
                   id="integraremrhfolhadehoras_ajax"
                   on-response="_integraremrhfolhadehorasResponse"
                   content-type="application/json">
        </iron-ajax>

        <iron-ajax url="/FolhasDeHoras/IntegrarEmRHKMFolhaDeHoras"
                   last-response="{{integrarEmRHKMFolhaDeHoras}}"
                   method="post"
                   handle-as="json"
                   id="integraremrhkmfolhadehoras_ajax"
                   on-response="_integraremrhkmfolhadehorasResponse"
                   content-type="application/json">
        </iron-ajax>

        <div class="subMenu">
            <paper-button class="tablinks" on-tap="_goBack" title="Voltar"><i class="fa fa-arrow-left" aria-hidden="true"></i> Voltar</paper-button>
            <paper-button id="btn_calcularAjudasCusto" class="tablinks" on-tap="_calcularAjudasCusto" disabled="{{ !_permissions.create }}" title="Calcular Aj. Custo"><i class="fa fa-check-square" aria-hidden="true"></i> Calcular Aj. Custo</paper-button>
            <paper-button id="btn_validarFolhaDeHoras" class="tablinks" on-tap="_validarFolhaDeHoras" disabled="{{ !_permissions.create }}" title="Validar"><i class="fa fa-check-square" aria-hidden="true"></i> Validar</paper-button>
            <paper-button id="btn_integrarEmRH" class="tablinks" on-tap="_integrarEmRH" disabled="{{ !_permissions.create }}" title="Integrar Aj. Custo"><i class="fa fa-check-square" aria-hidden="true"></i> Integrar Aj. Custo</paper-button>
            <paper-button id="btn_integrarEmRHKM" class="tablinks" on-tap="_integrarEmRHKM" disabled="{{ !_permissions.create }}" title="Integrar km"><i class="fa fa-check-square" aria-hidden="true"></i> Integrar km</paper-button>
            <paper-button id="btn_imprimirFH" class="tablinks" on-tap="_printFH" disabled="{{ !_permissions.create }}" title="Imprimir Folha de Horas"><i class="fa fa-print" aria-hidden="true"></i> Imprimir Folha de Horas</paper-button>
            <paper-button id="btn_updateFH1" raised class="tablinks" on-tap="_updateFH" disabled="{{ !_permissions.update }}" title="Gravar" style="background-color:#DADADA"><i class="fa fa-floppy-o" aria-hidden="true"></i>&nbsp; Gravar</paper-button>
        </div>

        <paper-tabs fit-container no-slide autoselect autoselect-delay="0" selected="{{selected}}">
            <paper-tab>Viagens</paper-tab>
            <paper-tab>Mão de Obra</paper-tab>
            <paper-tab>Presenças</paper-tab>
            <paper-tab>Detalhe</paper-tab>
        </paper-tabs>

        <iron-pages selected="{{selected}}">
            <!--Viagens-->
            <div class="panel panel-default">
                <div class="panel-heading" style="font-size:16px">Cabeçalho</div>
                <div class="panel-body">
                    <div class="row break_clear">
                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.folhaDeHorasNo}}" id="folhaDeHorasNo" name="folhaDeHorasNo" label="Nº Folha Horas" disabled="true"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <such-selectbox id="projetoNo" value="{{data.projetoNo}}" label="Nº Ordem/Projecto"
                                            items="[[LFolhaDeHoraNavProjectNo]]"
                                            text-path="no"
                                            value-path="no"
                                            fields='[{"field":"no", "name":"Nº Projecto"}, {"field":"description", "name":"Descrição"}, {"field":"customerNo", "name":"Nº Cliente"}, {"field":"globalDimension1", "name":"Dimensão Global 1"}, {"field":"globalDimension2", "name":"Dimensão Global 2"}]'
                                            disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório">
                            </such-selectbox>
                        </div>

                        <div class="col-sm-6">
                            <vaadin-combo-box items="[[LFolhaDeHoraEmployees]]" id="empregadoNo" item-value-path="id" item-label-path="value" value="{{data.empregadoNo}}" on-value-changed="_codeChange" label="Nº Empregado - Nome" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório">
                                <template>
                                    <paper-icon-item>
                                        <paper-item-body two-line>
                                            <div>[[item.value]]</div>
                                        </paper-item-body>
                                    </paper-icon-item>
                                </template>
                            </vaadin-combo-box>
                        </div>
                    </div>

                    <div class="row break_clear">
                        <div class="col-sm-3">
                            <label part="label" id="vaadin-text-field-label-21" class="label_custom">Data/Hora - Início</label>
                            <br />
                            <div class="row">
                                <div class="col-sm-8" style="padding-right: 5px;">
                                    <vaadin-date-picker id="dataPartidaTexto" name="dataPartidaTexto" value="{{data.dataPartidaTexto}}" on-blur="_validacaoDataPartidaChegada" disabled="{{ !_permissions.update }}"></vaadin-date-picker>
                                </div>
                                <div class="col-sm-4" style="padding-left: 0px;">
                                    <vaadin-text-field value="{{data.horaPartidaTexto}}" type="time" maxlength="8" id="horaPartidaTexto" name="horaPartidaTexto" disabled="{{ !_permissions.update }}"> </vaadin-text-field>
                                </div>
                            </div>
                        </div>

                        <!--<div class="col-sm-3">
                            <vaadin-date-picker label="Data Inicio" id="dataPartidaTexto" name="dataPartidaTexto" on-blur="_validacaoDataPartidaChegada" disabled="{{ !_permissions.update }}" value="{{data.dataPartidaTexto}}"></vaadin-date-picker>
                        </div>-->
                        <!--<div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.horaPartidaTexto}}" id="horaPartidaTexto" on-value-changed="_validacaoHoraPartidaChegada" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório" pattern="([01]?[0-9]{1}|2[0-3]{1}):[0-5]{1}[0-9]{1}" label="Hora Inicio"></vaadin-text-field>
                        </div>-->

                        <div class="col-sm-3">
                            <label part="label" id="vaadin-text-field-label-21" class="label_custom">Data/Hora - Fim</label>
                            <br />
                            <div class="row">
                                <div class="col-sm-8" style="padding-right: 5px;">
                                    <vaadin-date-picker id="dataChegadaTexto" name="dataChegadaTexto" value="{{data.dataChegadaTexto}}" on-blur="_validacaoDataPartidaChegada" disabled="{{ !_permissions.update }}"></vaadin-date-picker>
                                </div>
                                <div class="col-sm-4" style="padding-left: 0px;">
                                    <vaadin-text-field value="{{data.horaChegadaTexto}}" id="horaChegadaTexto" name="horaChegadaTexto" type="time" maxlength="8" disabled="{{ !_permissions.update }}"> </vaadin-text-field>
                                </div>
                            </div>
                        </div>

                        <!--<div class="col-sm-3">
                            <vaadin-date-picker label="Data Fim" id="dataChegadaTexto" name="dataChegadaTexto" on-blur="_validacaoDataPartidaChegada" disabled="{{ !_permissions.update }}" value="{{data.dataChegadaTexto}}"></vaadin-date-picker>
                        </div>-->
                        <!--<div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.horaChegadaTexto}}" id="horaChegadaTexto" on-value-changed="_validacaoHoraPartidaChegada" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório" pattern="([01]?[0-9]{1}|2[0-3]{1}):[0-5]{1}[0-9]{1}" label="Hora Fim"></vaadin-text-field>
                        </div>-->

                        <div class="col-sm-3">
                            <vaadin-combo-box items="[[LFolhaDeHoraTypeDeslocation]]" id="tipoDeslocacao" item-value-path="id" item-label-path="value" value="{{data.tipoDeslocacao}}" on-value-changed="_validacaoTipoDeslocacao" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório" label="Tipo Deslocação">
                                <template>
                                    <paper-icon-item>
                                        <paper-item-body two-line>
                                            <div>[[item.value]]</div>
                                        </paper-item-body>
                                    </paper-icon-item>
                                </template>
                            </vaadin-combo-box>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-combo-box items="[[LFolhaDeHoraCodeTypeKms]]" id="codigoTipoKms" item-value-path="id" item-label-path="value" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório" value="{{data.codigoTipoKms}}" label="Tipo km">
                                <template>
                                    <paper-icon-item>
                                        <paper-item-body two-line>
                                            <div>[[item.value]]</div>
                                        </paper-item-body>
                                    </paper-icon-item>
                                </template>
                            </vaadin-combo-box>
                        </div>
                    </div>

                    <div class="row break_clear">
                        <div class="col-sm-3">
                            <vaadin-combo-box items="[[LFolhaDeHoraViaturaMatricula]]" id="matricula" item-value-path="id" item-label-path="value" value="{{data.matricula}}" on-value-changed="_validacaoTipoDeslocacao" label="Matricula" disabled="{{ !_permissions.update }}">
                                <template>
                                    <paper-icon-item>
                                        <paper-item-body two-line>
                                            <div>[[item.value]]</div>
                                        </paper-item-body>
                                    </paper-icon-item>
                                </template>
                            </vaadin-combo-box>
                        </div>

                        <div class="col-sm-3 alignPoga">
                            <vaadin-checkbox checked="{{data.deslocacaoForaConcelho}}" id="deslocacaoForaConcelho" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório">Desloc. fora do concelho</vaadin-checkbox>
                            <vaadin-checkbox checked="{{data.deslocacaoPlaneada}}" id="deslocacaoPlaneada" disabled="true" hidden>Deslocação Planeada</vaadin-checkbox>
                            <vaadin-checkbox checked="{{data.terminada}}" id="terminada" disabled="{{ !_permissions.update }}" on-click="_validacaoTerminada" required error-message="Este campo é obrigatório">Terminado</vaadin-checkbox>
                        </div>

                        

                        <!--<div class="col-sm-3" style="padding-top:20px">
                            <paper-button raised id="btn_updateFH1" class="btnSave" on-tap="_updateFH" disabled="{{ !_permissions.update }}" title="Guardar"><i class="fa fa-floppy-o" aria-hidden="true"></i>&nbsp; Guardar</paper-button>
                        </div>-->
                    </div>

                    <!--<div class="marginSpace">
                    </div>-->
                </div>



                <!------------ PERCURSOS ------------>



                <paper-collapse-group>
                    <paper-collapse-item class="panel-heading" header="Percursos" closed>
                        <div class="panel-body">
                            <div class="row break_clear">
                                <div class="col-sm-4">
                                    <vaadin-combo-box id="percursoOrigem" items="[[LFolhaDeHoraPercursoOrigemDestino]]" item-value-path="id" item-label-path="value" label="Origem" on-value-changed="_DataInicio" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório">
                                        <template>
                                            <paper-icon-item>
                                                <paper-item-body two-line>
                                                    <div>[[item.value]]</div>
                                                </paper-item-body>
                                            </paper-icon-item>
                                        </template>
                                    </vaadin-combo-box>
                                </div>

                                <div class="col-sm-4">
                                    <vaadin-combo-box id="percursoDestino" items="[[LFolhaDeHoraPercursoOrigemDestino]]" item-value-path="id" item-label-path="value" label="Destino" on-value-changed="_DataInicio" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório">
                                        <template>
                                            <paper-icon-item>
                                                <paper-item-body two-line>
                                                    <div>[[item.value]]</div>
                                                </paper-item-body>
                                            </paper-icon-item>
                                        </template>
                                    </vaadin-combo-box>
                                </div>

                                <div class="col-sm-3">
                                    <vaadin-date-picker id="percursoDataViagem" label="Data Viagem" on-blur="_PercursoDataValidar" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório" value="{{data.dataViagemTexto}}"></vaadin-date-picker>
                                </div>



                                <!--<div class="col-sm-1" style="padding-top:23px">
                                    <paper-button id="btn_createPercurso" class="btnSave" raised on-tap="_createPercurso" disabled="{{ !_permissions.create }}" title="Criar">Criar</paper-button>
                                </div>-->
                                <div class="col-sm-1" style="padding-top:32px">
                                    <center>
                                        <paper-button id="btn_createPercurso" class="btnSave tableBtn" raised on-tap="_createPercurso" disabled="{{ !_permissions.create }}" title="Adicionar"><i class="fa fa-plus" aria-hidden="true"></i></paper-button>
                                    </center>
                                </div>
                            </div>
                        </div>
                    </paper-collapse-item>
                </paper-collapse-group>

                <div class="panel-body">
                    <vaadin-grid id="tabPercurso" aria-label="TabelaPercursos" items="{{ data.folhaDeHorasPercurso }}" class="editGrid" multi-sort="true">
                        <vaadin-grid-column resizable hidden>
                            <template class="header">
                                <vaadin-grid-sorter path="noLinha" style="text-align:center;">Nº Linha</vaadin-grid-sorter>
                                <vaadin-grid-filter path="noLinha"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field name="tabPercursoLinhaNo" id="tabPercursoLinhaNo" value="{{item.noLinha}}" maxlength="200" disabled="true"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="codOrigem" style="text-align:center;">Código Origem</vaadin-grid-sorter>
                                <vaadin-grid-filter path="codOrigem"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="tabPercursoOrigem" value="{{item.codOrigem}}" maxlength="200" disabled="true"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="descricaoOrigem" style="text-align:center;">Descrição Origem</vaadin-grid-sorter>
                                <vaadin-grid-filter path="descricaoOrigem"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field name="tabPercursoOrigemDescricao" value="{{item.descricaoOrigem}}" maxlength="200" disabled="true" style="text-align:left;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="codDestino" style="text-align:center;">Código Destino</vaadin-grid-sorter>
                                <vaadin-grid-filter path="codDestino"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="tabPercursoDestino" value="{{item.codDestino}}" maxlength="200" disabled="true"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="descricaoDestino" style="text-align:center;">Descrição Destino</vaadin-grid-sorter>
                                <vaadin-grid-filter path="descricaoDestino"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field name="tabPercursoDestinoDescricao" value="{{item.descricaoDestino}}" maxlength="200" disabled="true" style="text-align:left;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="dataDespesaTexto" style="text-align:center;">Data Viagem</vaadin-grid-sorter>
                                <vaadin-grid-filter path="dataDespesaTexto"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-date-picker id="tabPercursoDataViagemTexto" name="dataViagemTexto" value="{{item.dataDespesaTexto}}" on-blur="_updateLinhaPercurso" disabled="true" style="text-align:right;"></vaadin-date-picker>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="observacao" style="text-align:center;">Justificação</vaadin-grid-sorter>
                                <vaadin-grid-filter path="observacao"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field name="tabPercursoJustificacao" value="{{item.observacao}}" maxlength="200" on-blur="_updateLinhaPercurso" disabled="{{ !_permissions.update }}" style="text-align:left;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="distancia" style="text-align:center;">Distância Efectuada</vaadin-grid-sorter>
                                <vaadin-grid-filter path="distancia"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field name="tabPercursoDistancia" value="{{item.distancia}}" type="number" maxlength="9" pattern="[0-9]*" on-blur="_updateLinhaPercurso" disabled="{{ !_permissions.update }}" style="text-align:right;">
                                    <div slot="suffix">km</div>
                                </vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="distanciaPrevista" style="text-align:center;">Distância Prevista</vaadin-grid-sorter>
                                <vaadin-grid-filter path="distanciaPrevista"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field name="tabPercursoDistanciaPrevista" value="{{item.distanciaPrevista}}" type="number" maxlength="9" pattern="[0-9]*" style="text-align:right;" disabled="true">
                                    <div slot="suffix">km</div>
                                </vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="custoUnitario" style="text-align:center;">Custo Unitário</vaadin-grid-sorter>
                                <vaadin-grid-filter path="custoUnitario"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="GridtabPercursoCustoUnitario" name="tabPercursoCustoUnitario" value="{{item.custoUnitario}}" type="number" on-blur="_updateLinhaPercurso" disabled="true" maxlength="18" on-value-changed="_ConvertDecimals" pattern="[0-9]+([\.][0-9]+)?" style="text-align:right;">
                                    <div slot="suffix">€</div>
                                </vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="custoTotal" style="text-align:center;">Custo Total</vaadin-grid-sorter>
                                <vaadin-grid-filter path="custoTotal"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="GridtabPercursoCustoTotal" name="tabPercursoCustoTotal" value="{{item.custoTotal}}" type="number" on-blur="_updateLinhaPercurso" disabled="true" on-value-changed="_ConvertDecimals" maxlength="18" pattern="[0-9]+([\.][0-9]+)?" style="text-align:right;">
                                    <div slot="suffix">€</div>
                                </vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                            </template>
                            <template>
                                <t
                                <center>
                                    <!--<paper-button id="btn_deletePercurso" class="btnRemove" raised on-tap="_deletePercurso" disabled="{{ !_permissions.delete }}">Eliminar</paper-button>-->
                                    <paper-button id="btn_deletePercurso" class="btnRemove tableBtn" raised on-tap="_deletePercurso" disabled="{{ !_permissions.delete }}" title="Eliminar"><i class="fa fa-trash" aria-hidden="true"></i></paper-button>
                                </center>
                            </template>
                        </vaadin-grid-column>
                    </vaadin-grid>
                </div>



                <!------------ AJUDAS DE CUSTO / DESPESAS ------------>



                <paper-collapse-group>
                    <paper-collapse-item class="panel-heading" header="Ajudas de Custo / Despesas" closed>
                        <div class="panel-body">
                            <div class="row break_clear">
                                <div class="col-sm-2">
                                    <vaadin-combo-box id="ajudaTipoCusto" items="[[LFolhaDeHoraAjudaTipoCusto]]" item-value-path="id" item-label-path="value" label="Tipo Custo" ="_getAjudaCodTipoCusto" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório">
                                        <template>
                                            <paper-icon-item>
                                                <paper-item-body two-line>
                                                    <div>[[item.value]]</div>
                                                </paper-item-body>
                                            </paper-icon-item>
                                        </template>
                                    </vaadin-combo-box>
                                </div>

                                <div class="col-sm-2">
                                    <vaadin-combo-box id="ajudaCodigoTipoCusto" items="[[LFolhaDeHoraAjudaCodTipoCusto]]" item-value-path="id" item-label-path="value" label="Cód Tipo Custo" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório">
                                        <template>
                                            <paper-icon-item>
                                                <paper-item-body two-line>
                                                    <div>[[item.value]]</div>
                                                </paper-item-body>
                                            </paper-icon-item>
                                        </template>
                                    </vaadin-combo-box>
                                </div>

                                <div class="col-sm-1">
                                    <vaadin-text-field id="ajudaQuantidade" label="Quantidade" type="number" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório" maxlength="18" pattern="[0-9]*" style="text-align:right;"></vaadin-text-field>
                                </div>

                                <div class="col-sm-1">
                                    <vaadin-text-field id="ajudaCustoUnitario" label="Custo Unitário" type="number" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório" maxlength="18" on-value-changed="_ConvertDecimals" pattern="[0-9]+([\.][0-9]+)?" style="text-align:right;">
                                        <div slot="suffix">€</div>
                                    </vaadin-text-field>
                                </div>

                                <div class="col-sm-1">
                                    <vaadin-text-field id="ajudaPrecoUnitario" label="Preço Unitário" type="number" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório" maxlength="18" on-value-changed="_ConvertDecimals" pattern="[0-9]+([\.][0-9]+)?" style="text-align:right;">
                                        <div slot="suffix">€</div>
                                    </vaadin-text-field>
                                </div>

                                <div class="col-sm-2">
                                    <vaadin-date-picker id="ajudaDataDespesa" label="Data Despesa" on-blur="_AjudaDataValidar" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório" maxlength="10"></vaadin-date-picker>
                                </div>

                                <div class="col-sm-2" style="text-align:right">
                                    <vaadin-text-field id="ajudaJustificacao" label="Justificação" disabled="{{ !_permissions.update }}" style="text-align:left;"></vaadin-text-field>
                                </div>

                                <div class="col-sm-1" style="padding-top:30px">
                                    <center>
                                        <paper-button id="btn_createAjuda" class="btnSave tableBtn" raised on-tap="_createAjuda" disabled="{{ !_permissions.create }}" title="Adicionar"><i class="fa fa-plus" aria-hidden="true"></i></paper-button>
                                    </center>
                                </div>
                            </div>
                        </div>
                    </paper-collapse-item>
                </paper-collapse-group>

                <div class="panel-body">
                    <vaadin-grid id="tabAjuda" aria-label="Tabela Ajudas de Custo/Despesas" items="{{ data.folhaDeHorasAjuda }}" class="editGrid">
                        <vaadin-grid-column resizable hidden>
                            <template class="header">
                                <vaadin-grid-sorter path="noLinha" style="text-align:center;">Nº Linha</vaadin-grid-sorter>
                                <vaadin-grid-filter path="noLinha"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field name="tabAjudaLinhaNo" id="tabAjudaLinhaNo" value="{{item.noLinha}}" maxlength="200" disabled="true" style="text-align:right;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="descricaoTipoCusto" style="text-align:center;">Tipo Custo</vaadin-grid-sorter>
                                <vaadin-grid-filter path="descricaoTipoCusto"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="tabAjudaTipoCusto" value="{{item.descricaoTipoCusto}}" maxlength="200" disabled="true"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="descricaoCodTipoCusto" style="text-align:center;">Cód. Tipo Custo</vaadin-grid-sorter>
                                <vaadin-grid-filter path="descricaoCodTipoCusto"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="tabAjudaCodigoTipoCusto" value="{{item.descricaoCodTipoCusto}}" maxlength="200" disabled="true"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="quantidade" style="text-align:center;">Quantidade</vaadin-grid-sorter>
                                <vaadin-grid-filter path="quantidade"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field name="tabAjudaQuantidade" value="{{item.quantidade}}" type="number" maxlength="9" pattern="[0-9]*" style="text-align:right;" on-blur="_updateLinhaAjuda" disabled="{{ !_permissions.update }}"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="custoUnitario" style="text-align:center;">Custo Unitário</vaadin-grid-sorter>
                                <vaadin-grid-filter path="custoUnitario"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="GridtabAjudaCustoUnitario" name="tabAjudaCustoUnitario" value="{{item.custoUnitario}}" type="number" maxlength="12" pattern="[0-9]+([\.][0-9]+)?" style="text-align:right;" on-blur="_updateLinhaAjuda" disabled="{{ !_permissions.update }}" on-value-changed="_ConvertDecimals">
                                    <div slot="suffix">€</div>
                                </vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="custoTotal" style="text-align:center;">Custo Total</vaadin-grid-sorter>
                                <vaadin-grid-filter path="custoTotal"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="GridtabAjudaCustoTotal" name="tabAjudaCustoTotal" value="{{item.custoTotal}}" type="number" maxlength="18" on-value-changed="_ConvertDecimals" pattern="[0-9]+([\.][0-9]+)?" disabled="true" style="text-align:right;">
                                    <div slot="suffix">€</div>
                                </vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="precoUnitario" style="text-align:center;">Preço Unitário</vaadin-grid-sorter>
                                <vaadin-grid-filter path="precoUnitario"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="GridtabAjudaPrecoUnitario" name="tabAjudaPrecoUnitario" value="{{item.precoUnitario}}" on-blur="_updateLinhaAjuda" disabled="{{ !_permissions.update }}" type="number" maxlength="18" on-value-changed="_ConvertDecimals" pattern="[0-9]+([\.][0-9]+)?" style="text-align:right;">
                                    <div slot="suffix">€</div>
                                </vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="precoVenda" style="text-align:center;">Preço Venda</vaadin-grid-sorter>
                                <vaadin-grid-filter path="precoVenda"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="GridtabAjudaPrecoVenda" name="tabAjudaPrecoVenda" value="{{item.precoVenda}}" on-blur="_updateLinhaAjuda" disabled="{{ !_permissions.update }}" type="number" maxlength="18" on-value-changed="_ConvertDecimals" pattern="[0-9]+([\.][0-9]+)?" style="text-align:right;">
                                    <div slot="suffix">€</div>
                                </vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="dataDespesaTexto" style="text-align:center;">Data Despesa</vaadin-grid-sorter>
                                <vaadin-grid-filter path="dataDespesaTexto"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-date-picker id="tabAjudaDataDespesa" name="tabAjudaDataDespesa" value="{{item.dataDespesaTexto}}" on-blur="_updateLinhaAjuda" disabled="true" style="text-align:right;"></vaadin-date-picker>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="observacao" style="text-align:center;">Justificação</vaadin-grid-sorter>
                                <vaadin-grid-filter path="observacao"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field name="tabAjudaJustificacao" value="{{item.observacao}}" on-blur="_updateLinhaAjuda" disabled="{{ !_permissions.update }}" maxlength="200" style="text-align:left;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                            </template>
                            <
                            <template>
                                <center>

                                    <!--<paper-button class="btnRemove" raised on-tap="_deleteAjuda" disabled="{{ !_permissions.delete }}">Eliminar</paper-button>-->
                                    <paper-button class="btnRemove tableBtn" raised on-tap="_deleteAjuda" disabled="{{ !_permissions.delete }}" title="Eliminar"><i class="fa fa-trash" aria-hidden="true"></i></paper-button>
                                </center>
                            </template>
                        </vaadin-grid-column>
                </div>
            </div>



            <!------------ MÃO DE OBRA ------------>



            <div class="panel panel-default">
                <div class="panel-heading" style="font-size:16px">Cabeçalho</div>
                <div class="panel-body">
                    <div class="row break_clear">
                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.projetoNo}}" id="maodeobraprojetoNo" name="maodeobraprojetoNo" disabled="true" label="Nº Obra"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.projetoDescricao}}" disabled="true" id="maodeobraprojetoDescricao" name="projetoDescricao" label="Descrição"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.empregadoNo}}" id="maodeobraempregadoNo" name="maodeobraempregadoNo" disabled="true" label="Nº Empregado"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.empregadoNome}}" disabled="true" id="maodeobraempregadoNome" name="empregadoNome" label="Nome Empregado"></vaadin-text-field>
                        </div>
                    </div>
                </div>

                <paper-collapse-group>
                    <paper-collapse-item class="panel-heading" header="Mão de Obra">
                        <div class="panel-body">
                            <div class="row break_clear">
                                <div class="col-sm-2">
                                    <vaadin-date-picker id="maoDeObraDate" name="maoDeObraDate" label="Data" value="" on-blur="_MaoDeObraDataValidar" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório"></vaadin-date-picker>
                                </div>
                                <div class="col-sm-2">
                                    <such-selectbox id="maoDeObraProjetoNo" label="Nº Obra"
                                                    items="[[LFolhaDeHoraNavProjectNo]]"
                                                    text-path="no"
                                                    value-path="no"
                                                    fields='[{"field":"no","name":"Nº"},{"field":"description","name":"Descrição"},{"field":"customerNo","name":"Nº Cliente"},{"field":"globalDimension1","name":"Dimensão Global 1"},{"field":"globalDimension2","name":"Dimensão Global 2"}]'
                                                    on-change="_MaoDeObraProjecto" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório">
                                    </such-selectbox>
                                </div>

                                <div class="col-sm-3">
                                    <vaadin-combo-box items="[[LFolhaDeHoraTipoTrabalhoNo]]" id="maoDeObraCodigoTipoTrabalho" item-value-path="id" item-label-path="value" label="Tipo Trabalho" on-change="_MaoDeObraTipoTrabalho" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório">
                                        <template>
                                            <paper-icon-item>
                                                <paper-item-body two-line>
                                                    <div>[[item.value]]</div>
                                                </paper-item-body>
                                            </paper-icon-item>
                                        </template>
                                    </vaadin-combo-box>
                                </div>

                                <div class="col-sm-1">
                                    <vaadin-text-field id="maoDeObraHoraInicio" label="Hora de Início" on-blur="_MaoDeObraHoraInicioValidar" type="time" maxlength="8" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório"></vaadin-text-field>
                                </div>

                                <div class="col-sm-1 alignPoga">
                                    <vaadin-checkbox id="maoDeObraHorarioAlmoco" checked="{{chkAlmoco}}" disabled="{{ !_permissions.update }}">Almoço</vaadin-checkbox>
                                </div>

                                <div class="col-sm-1">
                                    <vaadin-text-field id="maoDeObraHoraFim" label="Hora de Fim" on-blur="_MaoDeObraHoraFimValidar" type="time" maxlength="8" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório"></vaadin-text-field>
                                </div>

                                <div class="col-sm-1 alignPoga">
                                    <vaadin-checkbox id="maoDeObraHorarioJantar" checked="{{chkJantar}}" disabled="{{ !_permissions.update }}">Jantar</vaadin-checkbox>
                                </div>



                                <!--<div class="col-sm-1 alignPoga">
                                    <paper-button id="btn_createMaoDeObra" class="btnSave" raised on-tap="_createMaoDeObra" disabled="{{ !_permissions.create }}" title="Criar">Criar</paper-button>
                                </div>-->
                                <div class="col-sm-1" style="padding-top:32px">
                                    <center>
                                        <paper-button id="btn_createMaoDeObra" class="btnSave tableBtn" raised on-tap="_createMaoDeObra" disabled="{{ !_permissions.create }}" title="Adicionar"><i class="fa fa-plus" aria-hidden="true"></i></paper-button>
                                    </center>
                                </div>
                            </div>
                        </div>
                    </paper-collapse-item>
                </paper-collapse-group>

                <div class="panel-body">
                    <vaadin-grid id="tabMaoDeObra" aria-label="Tabela Mão de Obra" items="{{ data.folhaDeHorasMaoDeObra }}" class="editGrid">
                        <vaadin-grid-column resizable hidden>
                            <template class="header">
                                <vaadin-grid-sorter path="linhaNo" style="text-align:center;">Nº Linha</vaadin-grid-sorter>
                                <vaadin-grid-filter path="linhaNo"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field name="tabMaoDeObraLinhaNo" id="tabMaoDeObraLinhaNo" value="{{item.linhaNo}}" on-blur="_updateLinhaMaoDeObra" maxlength="200" disabled="true" style="text-align:left;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="dateTexto">Data</vaadin-grid-sorter>
                                <vaadin-grid-filter path="dateTexto"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-date-picker id="tabMaoDeObraDate" name="tabMaoDeObraDate" value="{{item.dateTexto}}" on-blur="_updateLinhaMaoDeObra" disabled="true"></vaadin-date-picker>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="projetoNo" style="text-align:center;">Nº Obra</vaadin-grid-sorter>
                                <vaadin-grid-filter path="projetoNo"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-combo-box items="[[LFolhaDeHoraNavProjectNo]]" id="tabMaoDeObraProjetoNo" name="tabMaoDeObraProjetoNo" item-value-path="no" item-label-path="no" value="{{item.projetoNo}}" on-blur="_updateLinhaMaoDeObra" disabled="true" style="text-align:left;">
                                    <template>
                                        <paper-icon-item>
                                            <paper-item-body two-line>
                                                <div>[[item.value]]</div>
                                            </paper-item-body>
                                        </paper-icon-item>
                                    </template>
                                </vaadin-combo-box>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="codigoTipoTrabalho" style="text-align:center;">Cód. Tipo Trabalho</vaadin-grid-sorter>
                                <vaadin-grid-filter path="codigoTipoTrabalho"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-combo-box items="[[LFolhaDeHoraTipoTrabalhoNo]]" id="tabMaoDeObraCodigoTipoTrabalho" item-value-path="id" item-label-path="value" value="{{item.codigoTipoTrabalho}}" on-blur="_updateLinhaMaoDeObra" disabled="true" style="text-align:left;">
                                    <template>
                                        <paper-icon-item>
                                            <paper-item-body two-line>
                                                <div>[[item.value]]</div>
                                            </paper-item-body>
                                        </paper-icon-item>
                                    </template>
                                </vaadin-combo-box>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="horaInicioTexto" style="text-align:center;">Hora de Início</vaadin-grid-sorter>
                                <vaadin-grid-filter path="horaInicioTexto"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field name="tabMaoDeObraHoraInicioTexto" value="{{item.horaInicioTexto}}" on-blur="_updateLinhaMaoDeObra" disabled="{{ !_permissions.update }}" type="time" maxlength="8" style="text-align:right;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="horarioAlmoco" style="text-align:center;">Horário Almoço</vaadin-grid-sorter>
                            </template>
                            <template>
                                <vaadin-checkbox checked="{{item.horarioAlmoco}}" on-blur="_updateLinhaMaoDeObra" disabled="{{ !_permissions.update }}" style="text-align:center;"></vaadin-checkbox>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="horaFimTexto" style="text-align:center;">Hora de Fim</vaadin-grid-sorter>
                                <vaadin-grid-filter path="horaFimTexto"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field name="tabMaoDeObraHoraFimTexto" value="{{item.horaFimTexto}}" on-blur="_updateLinhaMaoDeObra" disabled="{{ !_permissions.update }}" type="time" maxlength="8" style="text-align:right;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="horarioJantar" style="text-align:center;">Horário Jantar</vaadin-grid-sorter>
                            </template>
                            <template>
                                <vaadin-checkbox checked="{{item.horarioJantar}}" on-blur="_updateLinhaMaoDeObra" disabled="{{ !_permissions.update }}" style="text-align:center;"></vaadin-checkbox>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="codigoFamiliaRecurso" style="text-align:center;">Nº Família Recurso</vaadin-grid-sorter>
                                <vaadin-grid-filter path="codigoFamiliaRecurso"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-combo-box items="[[LFolhaDeHoraGetRHRecursosFH]]" id="tabMaoDeObraCodigoFamiliaRecurso" item-value-path="id" item-label-path="value" value="{{item.codigoFamiliaRecurso}}" on-blur="_updateLinhaMaoDeObra" disabled="true" style="text-align:left;">
                                    <template>
                                        <paper-icon-item>
                                            <paper-item-body two-line>
                                                <div>[[item.value]]</div>
                                            </paper-item-body>
                                        </paper-icon-item>
                                    </template>
                                </vaadin-combo-box>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="horasNoTexto" style="text-align:center;">Nº Horas</vaadin-grid-sorter>
                                <vaadin-grid-filter path="horasNoTexto"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field name="tabMaoDeObraHorasNoTexto" value="{{item.horasNoTexto}}" on-blur="_updateLinhaMaoDeObra" type="time" maxlength="8" disabled="true" style="text-align:right;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="custoUnitarioDireto" style="text-align:center;">Custo Unit. Directo</vaadin-grid-sorter>
                                <vaadin-grid-filter path="custoUnitarioDireto"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="GridtabMaoDeObraCustoUnitarioDireto" name="tabMaoDeObraCustoUnitarioDireto" value="{{item.custoUnitarioDireto}}" on-blur="_updateLinhaMaoDeObra" disabled="true" on-value-changed="_ConvertDecimals" type="number" pattern="[0-9]+([\.][0-9]+)?" maxlength="18" style="text-align:right;">
                                    <div slot="suffix">€</div>
                                </vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="codigoCentroResponsabilidade" style="text-align:center;">Centro Responsabilidade</vaadin-grid-sorter>
                                <vaadin-grid-filter path="codigoCentroResponsabilidade"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-combo-box items="[[LFolhaDeHoraResponsabilityCenterCodes]]" id="tabMaoDeObraCodigoCentroResponsabilidade" item-value-path="id" item-label-path="value" value="{{item.codigoCentroResponsabilidade}}" on-blur="_updateLinhaMaoDeObra" disabled="true" style="text-align:left;">
                                    <template>
                                        <paper-icon-item>
                                            <paper-item-body two-line>
                                                <div>[[item.value]]</div>
                                            </paper-item-body>
                                        </paper-icon-item>
                                    </template>
                                </vaadin-combo-box>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="precoTotal" style="text-align:center;">Preço Total</vaadin-grid-sorter>
                                <vaadin-grid-filter path="precoTotal"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="GridtabMaoDeObraPrecoTotal" name="tabMaoDeObraPrecoTotal" value="{{item.precoTotal}}" on-blur="_updateLinhaMaoDeObra" disabled="true" on-value-changed="_ConvertDecimals" type="number" pattern="[0-9]+([\.][0-9]+)?" maxlength="18" style="text-align:right;">
                                    <div slot="suffix">€</div>
                                </vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                            </template>
                            te
                            <template>
                                <center>
                                    <!--<paper-button class="btnRemove" raised on-tap="_deleteMaoDeObra" disabled="{{ !_permissions.delete }}">Eliminar</paper-button>-->
                                    <paper-button class="btnRemove tableBtn" raised on-tap="_deleteMaoDeObra" disabled="{{ !_permissions.delete }}" title="Eliminar"><i class="fa fa-trash" aria-hidden="true"></i></paper-button>
                                </center>
                            </template>
                        </vaadin-grid-column>
                    </vaadin-grid>
                </div>
            </div>



            <!------------ PRESENÇAS ------------>



            <div class="panel panel-default">
                <div class="panel-heading" style="font-size:16px">Cabeçalho</div>
                <div class="panel-body">
                    <div class="row break_clear">
                        <div class="col-sm-6">
                            <vaadin-text-field type="text" value="{{data.empregadoNo}}" id="presencaempregadoNo" name="presencaempregadoNo" disabled="true" label="Nº Empregado"></vaadin-text-field>
                        </div>

                        <div class="col-sm-6">
                            <vaadin-text-field type="text" value="{{data.empregadoNome}}" disabled="true" id="empregadoNome" name="empregadoNome" label="Nome Empregado"></vaadin-text-field>
                        </div>
                    </div>
                </div>

                <paper-collapse-group>
                    <paper-collapse-item class="panel-heading" header="Presenças">
                        <div class="panel-body">
                            <div class="row break_clear">
                                <div class="col-sm-2">
                                    <vaadin-date-picker id="presencaDataTexto" label="Data" value="" on-blur="_PresencaDataValidar" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório"></vaadin-date-picker>
                                </div>

                                <div class="col-sm-1">
                                    <vaadin-text-field id="presencaHora1Entrada" label="1ª Entrada" type="time" on-blur="_presencaHora1EntradaValidar" maxlength="8" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório"></vaadin-text-field>
                                </div>

                                <div class="col-sm-1">
                                    <vaadin-text-field id="presencaHora1Saida" label="1ª Saída" type="time" on-blur="_presencaHora1SaidaValidar" maxlength="8" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório"></vaadin-text-field>
                                </div>

                                <div class="col-sm-1">
                                    <vaadin-text-field id="presencaHora2Entrada" label="2ª Entrada" type="time" on-blur="_presencaHora2EntradaValidar" maxlength="8" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório"></vaadin-text-field>
                                </div>

                                <div class="col-sm-1">
                                    <vaadin-text-field id="presencaHora2Saida" label="2ª Saída" type="time" on-blur="_presencaHora2SaidaValidar" maxlength="8" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório"></vaadin-text-field>
                                </div>

                                <div class="col-sm-5" style="text-align:right;">
                                    <vaadin-text-field id="presencaObservacoes" label="Observações" maxlength="200" disabled="{{ !_permissions.update }}" style="text-align:left;"></vaadin-text-field>
                                </div>



                                <!--<div class="col-sm-1 alignPoga">
                                    <paper-button id="btn_createPresenca" class="btnSave" raised on-tap="_createPresenca" disabled="{{ !_permissions.create }}" title="Criar">Criar</paper-button>
                                </div>-->
                                <div class="col-sm-1" style="padding-top:32px">
                                    <center>
                                        <paper-button id="btn_createPresenca" class="btnSave tableBtn" raised on-tap="_createPresenca" disabled="{{ !_permissions.create }}" title="Adicionar"><i class="fa fa-plus" aria-hidden="true"></i></paper-button>
                                    </center>
                                </div>
                            </div>
                        </div>
                    </paper-collapse-item>
                </paper-collapse-group>

                <div class="panel-body">
                    <vaadin-grid id="tabPresenca" aria-label="Tabela Presenças" items="{{ data.folhaDeHorasPresenca }}" class="editGrid">
                        <vaadin-grid-column resizable hidden>
                            <template class="header">
                                <vaadin-grid-sorter path="folhaDeHorasNo" style="text-align:center;">Nº Folha de Horas</vaadin-grid-sorter>
                                <vaadin-grid-filter path="folhaDeHorasNo"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field name="tabPresencaFolhaDeHorasNo" id="tabPresencaFolhaDeHorasNo" value="{{item.folhaDeHorasNo}}" maxlength="200" disabled="true" style="text-align:left;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="dataTexto" style="text-align:center;">Data</vaadin-grid-sorter>
                                <vaadin-grid-filter path="dataTexto"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-date-picker id="tabPresencaDataTexto" name="tabPresencaDataTexto" value="{{item.dataTexto}}" disabled="true" style="text-align:right;"></vaadin-date-picker>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="hora1Entrada" style="text-align:center;">1ª Entrada</vaadin-grid-sorter>
                                <vaadin-grid-filter path="hora1Entrada"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="tabPresencaHora1Entrada" name="tabPresencaHora1Entrada" value="{{item.hora1Entrada}}" disabled="{{ !_permissions.update }}" on-blur="_updateLinhaPresenca" type="time" maxlength="8" style="text-align:right;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="hora1Saida" style="text-align:center;">1ª Saída</vaadin-grid-sorter>
                                <vaadin-grid-filter path="hora1Saida"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="tabPresencaHora1Saida" name="tabPresencaHora1Saida" value="{{item.hora1Saida}}" disabled="{{ !_permissions.update }}" on-blur="_updateLinhaPresenca" type="time" maxlength="8" style="text-align:right;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="hora2Entrada" style="text-align:center;">2ª Entrada</vaadin-grid-sorter>
                                <vaadin-grid-filter path="hora2Entrada"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="tabPresencaHora2Entrada" name="tabPresencaHora2Entrada" value="{{item.hora2Entrada}}" disabled="{{ !_permissions.update }}" on-blur="_updateLinhaPresenca" type="time" maxlength="8" style="text-align:right;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="hora2Saida" style="text-align:center;">2ª Saída</vaadin-grid-sorter>
                                <vaadin-grid-filter path="hora2Saida"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="tabPresencaHora2Saida" name="tabPresencaHora2Saida" value="{{item.hora2Saida}}" disabled="{{ !_permissions.update }}" on-blur="_updateLinhaPresenca" type="time" maxlength="8" style="text-align:right;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                                <vaadin-grid-sorter path="observacoes" style="text-align:center;">Observações</vaadin-grid-sorter>
                                <vaadin-grid-filter path="observacoes"></vaadin-grid-filter>
                            </template>
                            <template>
                                <vaadin-text-field id="tabPresencaObservacoes" name="tabPresencaObservacoes" value="{{item.observacoes}}" disabled="{{ !_permissions.update }}" on-blur="_updateLinhaPresenca" maxlength="200" style="text-align:left;"></vaadin-text-field>
                            </template>
                        </vaadin-grid-column>

                        <vaadin-grid-column resizable>
                            <template class="header">
                            </template>
                            <t
                            <template>
                                <center>
                                    <!--<paper-button class="btnRemove" raised on-tap="_deletePresenca" disabled="{{ !_permissions.delete }}">Eliminar</paper-button>-->
                                    <paper-button class="btnRemove tableBtn" raised on-tap="_deletePresenca" disabled="{{ !_permissions.delete }}" title="Eliminar"><i class="fa fa-trash" aria-hidden="true"></i></paper-button>
                                </center>
                            </template>
                        </vaadin-grid-column>
                </div>
            </div>



            <!--DETALHE-->



            <div class="panel panel-default">
                <div class="panel-body">
                    <div class="row break_clear">
                        <div class="col-sm-3">
                            <vaadin-combo-box items="[[LFolhaDeHoraStatus]]" id="folhaDeHoraStatus" item-value-path="id" item-label-path="value" disabled="true" value="{{data.estado}}" label="Estado">
                                <template>
                                    <paper-icon-item>
                                        <paper-item-body two-line>
                                            <div>[[item.value]]</div>
                                        </paper-item-body>
                                    </paper-icon-item>
                                </template>
                            </vaadin-combo-box>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.criadoPor}}" id="criadoPor" name="criadoPor" disabled="true" label="Criado por"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <label part="label" id="vaadin-text-field-label-21" class="label_custom">Data/Hora - Criação</label>
                            <br />
                            <div class="row">
                                <div class="col-sm-8" style="padding-right: 5px;">
                                    <vaadin-date-picker id="dataCriacaoTexto" name="dataCriacaoTexto" value="{{data.dataCriacaoTexto}}" type="date" disabled="true"></vaadin-date-picker>
                                </div>
                                <div class="col-sm-4" style="padding-left: 0px;">
                                    <vaadin-text-field id="horaCriacaoTexto" name="horaCriacaoTexto" value="{{data.horaCriacaoTexto}}" type="time" disabled="true"></vaadin-text-field>
                                </div>
                                v>
                            </div>
                        </div>

                        <!--<div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.dataCriacaoTexto}}" id="dataCriacaoTexto" name="dataCriacaoTexto" disabled="true" label="Data Criação"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.horaCriacaoTexto}}" id="horaCriacaoTexto" name="horaCriacaoTexto" disabled="true" label="Hora Criação"></vaadin-text-field>
                        </div>-->
                    </div>
                    <div class="row break_clear">
                        <div class="col-sm-3">
                            <vaadin-combo-box items="[[LFolhaDeHoraRegionCodes]]" id="codigoRegiao" item-value-path="id" item-label-path="value" value="{{data.codigoRegiao}}" disabled="{{ !_permissions.update }}" label="Região" required error-message="Este campo é obrigatório">
                                <template>
                                    <table width="300px">
                                        <tr>
                                            <td width="15%">[[item.id]]</td>
                                            <td width="85%"> <b>[[item.value]]</b></td>
                                        </tr>
                                    </table>
                                </template>

                            </vaadin-combo-box>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-combo-box items="[[LFolhaDeHoraFunctionalAreaCodes]]" id="codigoAreaFuncional" item-value-path="id" item-label-path="value" value="{{data.codigoAreaFuncional}}" disabled="{{ !_permissions.update }}" label="Área Funcional" required error-message="Este campo é obrigatório">
                                <template>
                                    <table width="400px">
                                        <tr>
                                            <td width="20%">[[item.id]]</td>
                                            <td width="80%"> <b>[[item.value]]</b></td>
                                        </tr>
                                    </table>
                                </template>

                            </vaadin-combo-box>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-combo-box items="[[LFolhaDeHoraResponsabilityCenterCodes]]" id="codigoCentroResponsabilidade" item-value-path="id" item-label-path="value" value="{{data.codigoCentroResponsabilidade}}" disabled="{{ !_permissions.update }}" label="Centro Respon." required error-message="Este campo é obrigatório">
                                <template>
                                    <table width="350px">
                                        <tr>
                                            <td width="10%">[[item.id]]</td>
                                            <td width="90%"> <b>[[item.value]]</b></td>
                                        </tr>
                                    </table>
                                </template>
                            </vaadin-combo-box>
                        </div>
                    </div>

                    <div class="row break_clear">
                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.terminadoPor}}" id="terminadoPor" name="terminadoPor" disabled="true" label="Terminado por"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <label part="label" id="vaadin-text-field-label-21" class="label_custom">Data/Hora - Terminado</label>
                            <br />
                            <div class="row">
                                <div class="col-sm-8" style="padding-right: 5px;">
                                    <vaadin-date-picker id="dataTerminadoTexto" name="dataTerminadoTexto" value="{{data.dataTerminadoTexto}}" disabled="true"></vaadin-date-picker>
                                </div>
                                <div class="col-sm-4" style="padding-left: 0px;">
                                    <vaadin-text-field id="horaTerminadoTexto" name="horaTerminadoTexto" value="{{data.horaTerminadoTexto}}" type="time" disabled="true"></vaadin-text-field>
                                </div>
                                v>
                            </div>
                        </div>

                        <!--<div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.dataTerminadoTexto}}" id="dataTerminadoTexto" name="dataTerminadoTexto" disabled="true" label="Data Terminado"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.horaTerminadoTexto}}" id="horaTerminadoTexto" name="horaTerminadoTexto" disabled="true" label="Hora Terminado"></vaadin-text-field>
                        </div>-->
                    </div>
                    <div class="row break_clear">
                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.validadores}}" id="validadores" name="validadores" disabled="true" label="Validadores"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.validador}}" id="validador" name="validador" disabled="true" label="Validador"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <label part="label" id="vaadin-text-field-label-21" class="label_custom">Data/Hora - Validação</label>
                            <br />
                            <div class="row">
                                <div class="col-sm-8" style="padding-right: 5px;">
                                    <vaadin-date-picker id="dataValidacaoTexto" name="dataValidacaoTexto" value="{{data.dataValidacaoTexto}}" disabled="true"></vaadin-date-picker>
                                </div>
                                <div class="col-sm-4" style="padding-left: 0px;">
                                    <vaadin-text-field id="horaValidacaoTexto" name="horaValidacaoTexto" value="{{data.horaValidacaoTexto}}" type="time" disabled="true"></vaadin-text-field>
                                </div>
                                v>
                            </div>
                        </div>

                        <!--<div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.dataValidacaoTexto}}" id="dataValidacaoTexto" name="dataValidacaoTexto" disabled="true" label="Data Validação"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.horaValidacaoTexto}}" id="horaValidacaoTexto" name="horaValidacaoTexto" disabled="true" label="Hora Validação"></vaadin-text-field>
                        </div>-->

                        <div class="col-sm-3 alignPoga" style="padding-left:28px">
                            <vaadin-checkbox checked="{{data.validado}}" id="validado" disabled="true">Validado</vaadin-checkbox>
                        </div>
                    </div>
                    <div class="row break_clear">
                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.integradoresEmRH}}" id="integradoresEmRH" name="integradoresEmRH" disabled="true" label="Integradores Aj. Custo"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.integradorEmRH}}" id="integradorEmRH" name="integradorEmRH" disabled="true" label="Integrador Aj. Custo RH"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <label part="label" id="vaadin-text-field-label-21" class="label_custom">Data/Hora - Integrar Aj. Custo RH</label>
                            <br />
                            <div class="row">
                                <div class="col-sm-8" style="padding-right: 5px;">
                                    <vaadin-date-picker id="dataIntegracaoEmRHTexto" name="dataIntegracaoEmRHTexto" value="{{data.dataIntegracaoEmRHTexto}}" disabled="true"></vaadin-date-picker>
                                </div>
                                <div class="col-sm-4" style="padding-left: 0px;">
                                    <vaadin-text-field id="horaIntegracaoEmRHTexto" name="horaIntegracaoEmRHTexto" value="{{data.horaIntegracaoEmRHTexto}}" type="time" disabled="true"></vaadin-text-field>
                                </div>
                                v>
                            </div>
                        </div>

                        <!--<div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.dataIntegracaoEmRHTexto}}" id="dataIntegracaoEmRHTexto" name="dataIntegracaoEmRHTexto" disabled="true" label="Data Integ. Aj. Custo RH"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.horaIntegracaoEmRHTexto}}" id="horaIntegracaoEmRHTexto" name="horaIntegracaoEmRHTexto" disabled="true" label="Hora Integ. Aj. Custo RH"></vaadin-text-field>
                        </div>-->

                        <div class="col-sm-3">
                            <div class="col-sm-6">
                                <vaadin-text-field value="{{data.custoTotalHoras}}" id="custoTotalHoras" name="custoTotalHoras" type="number" disabled="true" class="alignRight" label="Custo Total Horas">
                                    <div slot="suffix">€</div>
                                </vaadin-text-field>
                            </div>
                            <div class="col-sm-6">
                                <vaadin-text-field value="{{data.custoTotalAjudaCusto}}" id="custoTotalAjudaCusto" name="custoTotalAjudaCusto" type="number" disabled="true" class="alignRight" label="Custo Total Ajuda Custo">
                                    <div slot="suffix">€</div>
                                </vaadin-text-field>
                            </div>
                        </div>
                    </div>
                    <div class="row break_clear">
                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.integradoresEmRHKM}}" id="integradoresEmRHKM" name="integradorEmRHKM" disabled="true" label="Integradores km RH"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.integradorEmRHKM}}" id="integradorEmRHKM" name="integradorEmRHKM" disabled="true" label="Integrador km RH"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <label part="label" id="vaadin-text-field-label-21" class="label_custom">Data/Hora - Integrar km RH</label>
                            <br />
                            <div class="row">
                                <div class="col-sm-8" style="padding-right: 5px;">
                                    <vaadin-date-picker id="dataIntegracaoEmRHKMTexto" name="dataIntegracaoEmRHKMTexto" value="{{data.dataIntegracaoEmRHKMTexto}}" disabled="true"></vaadin-date-picker>
                                </div>
                                <div class="col-sm-4" style="padding-left: 0px;">
                                    <vaadin-text-field id="horaIntegracaoEmRHKMTexto" name="horaIntegracaoEmRHKMTexto" value="{{data.horaIntegracaoEmRHKMTexto}}" type="time" disabled="true"></vaadin-text-field>
                                </div>
                                v>
                                </
                            </div>
                        </div>

                        <!--<div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.dataIntegracaoEmRHKMTexto}}" id="dataIntegracaoEmRHKMTexto" name="dataIntegracaoEmRHKMTexto" disabled="true" label="Data Integ. km RH"></vaadin-text-field>
                        </div>

                        <div class="col-sm-3">
                            <vaadin-text-field type="text" value="{{data.horaIntegracaoEmRHKMTexto}}" id="horaIntegracaoEmRHKMTexto" name="horaIntegracaoEmRHKMTexto" disabled="true" label="Hora Integ. km RH"></vaadin-text-field>
                        </div>-->

                        <div class="col-sm-3">
                            <div class="col-sm-6">
                                <vaadin-text-field value="{{data.numTotalKM}}" id="numTotalKM" name="numTotalKM" type="number" disabled="true" class="alignRight" label="Nº Total km">
                                    <div slot="suffix">km</div>
                                </vaadin-text-field>
                            </div>
                            <div class="col-sm-6">
                                <vaadin-text-field value="{{data.custoTotalKM}}" id="custoTotalKM" name="custoTotalKM" type="number" disabled="true" class="alignRight" label="Custo Total km">
                                    <div slot="suffix">€</div>
                                </vaadin-text-field>
                            </div>
                        </div>
                        

                    </div>

                    

                    <div class="row break_clear">
                        r"
                        <div class="col-sm-12">
                            <!--<vaadin-text-field type="text" value="{{data.observacoes}}" id="observacoes" name="observacoes" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório" label="Observações"></vaadin-text-field>-->
                            <such-textarea rows="5" type="text" value="{{data.observacoes}}" id="observacoes" name="observacoes" disabled="{{ !_permissions.update }}" required error-message="Este campo é obrigatório" label="Observações"> </such-textarea>
                        </div>
                        

                        di
                    </div>

                    <!--<div class="marginSpace">
                        <paper-button raised id="btn_updateFH2" class="btnSave" on-tap="_updateFH" disabled="{{ !_permissions.update }}" title="Guardar"><i class="fa fa-floppy-o" aria-hidden="true"></i>&nbsp; Guardar</paper-button>
                    </div>-->
                </div>
            </div>
        </iron-pages>

        <paper-toast id="ToastMessageSuccess" duration="4000" horizontalAlign="right" class="toastSuccess">&nbsp;<i class="fa fa-check fa-lg" aria-hidden="true"></i></paper-toast>
        <paper-toast id="ToastMessageError" duration="4000" horizontalAlign="right" class="toastError">&nbsp;<i class="fa fa-exclamation-triangle" aria-hidden="true"></i></paper-toast>

        <paper-dialog id="rptDialog" class="dialgoBox" modal>
            <div class="buttons">
                <paper-button class="btnRemove" on-tap="_closeRptDialog" title="Fechar"><i class="fa fa-close" aria-hidden="true"></i>&nbsp; Fechar</paper-button>
            </div>
            <iframe id="rptContainer" src="" frameborder="0" style="width: 100%; height: 92%; margin: 0px; padding: 0px"></iframe>
        </paper-dialog>
    </template>

    <script>
        document.addEventListener('WebComponentsReady', function () {
            //debugger;
            Polymer({
                is: 'x-folhadehoradetails',
                properties: {
                    _areaid: {
                        type: Number,
                        notify: true,
                        value: 0
                    },
                    _folhadehoraid: {
                        type: String,
                        notify: true,
                        value: ""
                    },
                    _permissions: {
                        type: Array
                    },
                    _estado: {
                        type: Number,
                        notify: true,
                        value: 0
                    },
                    _validacao: {
                        type: Number,
                        notify: true,
                        value: 0
                    },
                    _integracaoajuda: {
                        type: Number,
                        notify: true,
                        value: 0
                    },
                    _integracaokms: {
                        type: Number,
                        notify: true,
                        value: 0
                    },
                    selected: {
                        type: Number,
                        value: 0
                    },
                    _userlogin: {
                        type: String,
                        notify: true,
                        value: ""
                    },
                    chkAlmoco: {
                        type: Boolean,
                        notify: true,
                        value: true
                    },
                    chkJantar: {
                        type: Boolean,
                        notify: true,
                        value: true
                    },
                    valDataPartidaChegada: {
                        type: Boolean,
                        notify: true,
                        value: false
                    },
                    _isCreate: {
                        type: Boolean,
                        value: false
                    },
                    _reportserverurl: {
                        type: String,
                    },
                },

                ready: function () {
                    //debugger;
                    //GET FOLHADEHORA DATA
                    this.$.page_databound_ajax.body = JSON.stringify({ "folhaDeHorasNo": this._folhadehoraid });
                    this.$.page_databound_ajax.generateRequest();
                },

                //Mostra Mensagens
                _showMessage: function (message) {
                    //debugger;
                    this.$.ToastMessageSuccess.text = message;
                    this.$.ToastMessageSuccess.open();
                },

                //Mostra Mensagens de Erro
                _showErrorMessage: function (message) {
                    //debugger;
                    this.$.ToastMessageError.text = message;
                    this.$.ToastMessageError.open();
                },

                //Troca o caracter , por .
                _ConvertDecimals: function (e) {
                    e.target.value = e.target.value.replace(",", ".");
                },

                _validateFolhaHoras: function () {
                    //debugger;
                    if (this.$.projetoNo.value != "") {
                        if (this.$.empregadoNo.validate() & this.$.empregadoNo.value != "") {
                            if (this.$.dataPartidaTexto.validate() & this.$.dataPartidaTexto.value != "") {
                                if (this.$.horaPartidaTexto.validate() & this.$.horaPartidaTexto.value != "") {
                                    if (this.$.dataChegadaTexto.validate() & this.$.dataChegadaTexto.value != "") {
                                        if (this.$.horaChegadaTexto.validate() & this.$.horaChegadaTexto.value != "") {
                                            if (this.$.tipoDeslocacao.validate() & this.$.tipoDeslocacao.value != "") {
                                                if (this.$.codigoTipoKms.validate() & this.$.codigoTipoKms.value != "") {
                                                    if (this.$.codigoRegiao.validate() & this.$.codigoRegiao.value != "") {
                                                        if (this.$.codigoAreaFuncional.validate() & this.$.codigoAreaFuncional.value != "") {
                                                            if (this.$.codigoCentroResponsabilidade.validate() & this.$.codigoCentroResponsabilidade.value != "") {
                                                                if (this._validacaoDataPartidaChegada()) {
                                                                    if (this._validacaoHoraPartidaChegada()) {
                                                                        return true;
                                                                    }
                                                                    else {
                                                                        this._showErrorMessage('O campo Data-Hora Início tem que ser inferior ou igual ao campo Data-Hora Fim.');
                                                                        return false;
                                                                    }
                                                                }
                                                                else {
                                                                    this._showErrorMessage('A data Início ou a data Fim no cabeçalho não está correta.');
                                                                    return false;
                                                                }
                                                            }
                                                            else {
                                                                this._showErrorMessage("Falta preencher o campo Código Centro Respon..");
                                                                return false;
                                                            }
                                                        }
                                                        else {
                                                            this._showErrorMessage("Falta preencher o campo Código Área Funcional.");
                                                            return false;
                                                        }
                                                    }
                                                    else {
                                                        this._showErrorMessage("Falta preencher o campo Código Região.");
                                                        return false;
                                                    }
                                                }
                                                else {
                                                    this._showErrorMessage("Falta preencher o campo Cód. Tipo km.");
                                                    return false;
                                                }
                                            }
                                            else {
                                                this._showErrorMessage("Falta preencher o campo Tipo Deslocação.");
                                                return false;
                                            }
                                        }
                                        else {
                                            this._showErrorMessage("Falta preencher o campo Hora Fim.");
                                            return false;
                                        }
                                    }
                                    else {
                                        this._showErrorMessage("Falta preencher o campo Data Fim.");
                                        return false;
                                    }
                                }
                                else {
                                    this._showErrorMessage("Falta preencher o campo Hora Inicio.");
                                    return false;
                                }
                            }
                            else {
                                this._showErrorMessage("Falta preencher o campo Data Inicio.");
                                return false;
                            }
                        }
                        else {
                            this._showErrorMessage("Falta preencher o campo Nº Empregado.");
                            return false;
                        }
                    }
                    else {
                        this._showErrorMessage("Falta preencher o campo Nº Ordem/Projecto.");
                        return false;
                    }
                },

                _validatePercurso: function () {
                    if (this.$.percursoOrigem.validate() & this.$.percursoOrigem.value != "") {
                        if (this.$.percursoDestino.validate() & this.$.percursoDestino.value != "") {
                            if (this.$.percursoDataViagem.validate() & this.$.percursoDataViagem.value != "") {
                                return true;
                            }
                            else {
                                this._showErrorMessage("Falta preencher o campo Data Despesa.");
                                return false;
                            }
                        }
                        else {
                            this._showErrorMessage("Falta preencher o campo Código Destino.");
                            return false;
                        }
                    }
                    else {
                        this._showErrorMessage("Falta preencher o campo Código Origem.");
                        return false;
                    }
                },

                _validateAjuda: function () {
                    if (this.$.ajudaTipoCusto.validate() & this.$.ajudaTipoCusto.value != "") {
                        if (this.$.ajudaCodigoTipoCusto.validate() & this.$.ajudaCodigoTipoCusto.value != "") {
                            if (this.$.ajudaQuantidade.validate() & this.$.ajudaQuantidade.value != "") {
                                if (this.$.ajudaCustoUnitario.validate() & this.$.ajudaCustoUnitario.value != "") {
                                    if (this.$.ajudaPrecoUnitario.validate() & this.$.ajudaPrecoUnitario.value != "") {
                                        if (this.$.ajudaDataDespesa.validate() & this.$.ajudaDataDespesa.value != "") {
                                            return true;
                                        }
                                        else {
                                            this._showErrorMessage("Falta preencher o campo Data Despesa.");
                                            return false;
                                        }
                                    }
                                    else {
                                        this._showErrorMessage("Falta preencher o campo Preço Unitário.");
                                        return false;
                                    }
                                }
                                else {
                                    this._showErrorMessage("Falta preencher o campo Custo Unitário.");
                                    return false;
                                }
                            }
                            else {
                                this._showErrorMessage("Falta preencher o campo Quantidade.");
                                return false;
                            }
                        }
                        else {
                            this._showErrorMessage("Falta preencher o campo Cód Tipo Custo.");
                            return false;
                        }
                    }
                    else {
                        this._showErrorMessage("Falta preencher o campo Tipo Custo.");
                        return false;
                    }
                },

                _validateMaoDeObra: function () {
                    if (this.$.maoDeObraDate.validate() & this.$.maoDeObraDate.value != "") {
                        if (this.$.maoDeObraProjetoNo.value != "") {
                            if (this.$.maoDeObraCodigoTipoTrabalho.validate() & this.$.maoDeObraCodigoTipoTrabalho.value != "") {
                                if (this.$.maoDeObraHoraInicio.validate() & this.$.maoDeObraHoraInicio.value != "") {
                                    if (this.$.maoDeObraHoraFim.validate() & this.$.maoDeObraHoraFim.value != "") {
                                        return true;
                                    }
                                    else {
                                        this._showErrorMessage("Falta preencher o campo Hora de Fim.");
                                        return false;
                                    }
                                }
                                else {
                                    this._showErrorMessage("Falta preencher o campo Hora de Início.");
                                    return false;
                                }
                            }
                            else {
                                this._showErrorMessage("Falta preencher o campo Tipo Trabalho.");
                                return false;
                            }
                        }
                        else {
                            this._showErrorMessage("Falta preencher o campo Nº Obra.");
                            return false;
                        }
                    }
                    else {
                        this._showErrorMessage("Falta preencher o campo Data.");
                        return false;
                    }
                },

                _validatePresenca: function () {
                    if (this.$.presencaDataTexto.validate() & this.$.presencaDataTexto.value != "") {
                        if (this.$.presencaHora1Entrada.validate() & this.$.presencaHora1Entrada.value != "") {
                            if (this.$.presencaHora1Saida.validate() & this.$.presencaHora1Saida.value != "") {
                                if (this.$.presencaHora2Entrada.validate() & this.$.presencaHora2Entrada.value != "") {
                                    if (this.$.presencaHora2Saida.validate() & this.$.presencaHora2Saida.value != "") {
                                        return true;
                                    }
                                    else {
                                        this._showErrorMessage("Falta preencher o campo 2ª Saída.");
                                        return false;
                                    }
                                }
                                else {
                                    this._showErrorMessage("Falta preencher o campo 2ª Entrada.");
                                    return false;
                                }
                            }
                            else {
                                this._showErrorMessage("Falta preencher o campo 1ª Saída.");
                                return false;
                            }
                        }
                        else {
                            this._showErrorMessage("Falta preencher o campo 1ª Entrada.");
                            return false;
                        }
                    }
                    else {
                        this._showErrorMessage("Falta preencher o campo Data.");
                        return false;
                    }
                },

                //FOLHA DE HORAS
                _updateFH: function () {
                    //debugger;
                    this.$.page_updatefolhadehorasvalidacao_ajax.body = JSON.stringify(this.data);
                    this.$.page_updatefolhadehorasvalidacao_ajax.generateRequest();
                },

                _validacaoDataPartidaChegada: function () {
                    //debugger;
                    if (this.$.dataPartidaTexto.value != "" & this.$.dataPartidaTexto.validate() &
                        this.$.dataChegadaTexto.value != "" & this.$.dataChegadaTexto.validate()) {

                        var myDataPartida = new Date(this.$.dataPartidaTexto.value);
                        var myDataChegada = new Date(this.$.dataChegadaTexto.value);
                        var myDataHoje = new Date();

                        if (myDataChegada < myDataPartida) {
                            this._showErrorMessage('O campo Data Fim tem que ser superior ou igual ao campo Data Inicio.');
                            return false;
                        }
                        if (myDataPartida > myDataHoje) {
                            this._showErrorMessage('O campo Data Inicio tem que ser inferior ou igual á data hoje.');
                            return false;
                        }
                        if (myDataChegada > myDataHoje) {
                            this._showErrorMessage('O campo Data Fim tem que ser inferior ou igual á data hoje.');
                            return false;
                        }

                        return true;
                    }
                    return false;
                },

                _validacaoHoraPartidaChegada: function () {
                    //debugger;
                    if (this.$.dataPartidaTexto.value != "" & this.$.dataPartidaTexto.validate() &
                        this.$.dataChegadaTexto.value != "" & this.$.dataChegadaTexto.validate()) {

                        if (this.$.horaPartidaTexto.value != "" & this.$.horaPartidaTexto.validate() &
                            this.$.horaChegadaTexto.value != "" & this.$.horaChegadaTexto.validate()) {

                            var myDataPartida = new Date(this.$.dataPartidaTexto.value).toDateString();
                            var myDataChegada = new Date(this.$.dataChegadaTexto.value).toDateString();

                            var myDataHoraPartida = new Date(myDataPartida + ' ' + this.$.horaPartidaTexto.value);
                            var myDataHoraChegada = new Date(myDataChegada + ' ' + this.$.horaChegadaTexto.value);

                            if (myDataHoraPartida > myDataHoraChegada) {
                                this._showErrorMessage('O campo Data-Hora Início tem que ser inferior ou igual ao campo Data-Hora Fim.');
                                return false;
                            }
                            return true;
                        }
                    }
                    return false;
                },

                _validacaoTipoDeslocacao: function () {
                    //debugger;
                    if (this.$.tipoDeslocacao.value != "" & this.$.tipoDeslocacao.value != "1") {

                        if (this.$.matricula.value != "") {
                            this.$.matricula.value = "";
                        }
                    }
                },

                _validacaoTerminada: function () {
                    if (this.data.terminada == true)
                        this.data.terminada = false;
                    else if (this.data.terminada == false)
                        this.data.terminada = true;

                    var ok = 0;
                    var ajax_request = this.$.terminarfolhadehoras_ajax;

                    if (this.data.terminada == true) {
                        if (this._validateFolhaHoras()) {
                            if (this.$.tipoDeslocacao.value == 1) {
                                if (this.$.matricula.validate() & this.$.matricula.value != "") {
                                    ok = 1;
                                }
                                else {
                                    this._showErrorMessage("Falta preencher o campo Matrícula.");
                                }
                            }
                            else {
                                ok = 1;
                            }
                        }
                    }

                    if (ok == 1) {
                        var terminada_FolhaDeHorasNo = this.$.folhaDeHorasNo.value;
                        var terminada_Area = this.data.codigoArea;
                        var terminada_ProjetoNo = this.$.projetoNo.value;
                        var terminada_EmpregadoNo = this.$.empregadoNo.value;
                        var terminada_DataPartidaTexto = this.$.dataPartidaTexto.value;
                        var terminada_HoraPartidaTexto = this.$.horaPartidaTexto.value;
                        var terminada_DataChegadaTexto = this.$.dataChegadaTexto.value
                        var terminada_HoraChegadaTexto = this.$.horaChegadaTexto.value;
                        var terminada_TipoDeslocacao = this.$.tipoDeslocacao.value;
                        var terminada_CodigoTipoKms = this.$.codigoTipoKms.value;
                        var terminada_Matricula = this.$.matricula.value;
                        var terminada_DeslocacaoForaConcelho = this.data.deslocacaoForaConcelho;
                        var terminada_Terminada = null;
                        var terminada_Estado = this.$.folhaDeHoraStatus.value;
                        var terminada_CriadoPor = this.$.criadoPor.value;
                        var terminada_CodigoRegiao = this.$.codigoRegiao.value;
                        var terminada_CodigoAreaFuncional = this.$.codigoAreaFuncional.value;
                        var terminada_CodigoCentroResponsabilidade = this.$.codigoCentroResponsabilidade.value;
                        var terminada_Validado = this.data.validado;
                        var terminada_Validadores = this.$.validadores.value;
                        var terminada_Validador = this.$.validador.value;
                        var terminada_DataValidacaoTexto = this.$.dataValidacaoTexto.value;
                        var terminada_HoraValidacaoTexto = this.$.horaValidacaoTexto.value;
                        var terminada_IntegradoresEmRH = this.$.integradoresEmRH.value;
                        var terminada_IntegradorEmRH = this.$.integradorEmRH.value;
                        var terminada_DataIntegracaoEmRHTexto = this.$.dataIntegracaoEmRHTexto.value;
                        var terminada_HoraIntegracaoEmRHTexto = this.$.horaIntegracaoEmRHTexto.value;
                        var terminada_IntegradoresEmRHKM = this.$.integradoresEmRHKM.value;
                        var terminada_IntegradorEmRHKM = this.$.integradorEmRHKM.value;
                        var terminada_DataIntegracaoEmRHKMTexto = this.$.dataIntegracaoEmRHKMTexto.value;
                        var terminada_HoraIntegracaoEmRHKMTexto = this.$.horaIntegracaoEmRHKMTexto.value;
                        var terminada_CustoTotalAjudaCusto = this.$.custoTotalAjudaCusto.value;
                        var terminada_CustoTotalHoras = this.$.custoTotalHoras.value;
                        var terminada_CustoTotalKM = this.$.custoTotalKM.value;
                        var terminada_NumTotalKM = this.$.numTotalKM.value;
                        var terminada_Observacoes = this.$.observacoes.value;

                        bootbox.confirm({
                            message: "Tem a certeza que pretende Terminar a Folha de Horas?",
                            buttons: {
                                confirm: {
                                    label: 'Sim',
                                    className: 'btn-success'
                                },
                                cancel: {
                                    label: 'Não',
                                    className: 'btn-danger'
                                }
                            },
                            callback: function (terminarFolhaHoras) {
                                if (terminarFolhaHoras) {
                                    terminada_Terminada = true;
                                }
                                else {
                                    terminada_Terminada = false;
                                };

                                ajax_request.body = JSON.stringify({
                                    folhaDeHorasNo: terminada_FolhaDeHorasNo,
                                    projetoNo: terminada_ProjetoNo,
                                    empregadoNo: terminada_EmpregadoNo,
                                    dataPartidaTexto: terminada_DataPartidaTexto,
                                    horaPartidaTexto: terminada_HoraPartidaTexto,
                                    dataChegadaTexto: terminada_DataChegadaTexto,
                                    horaChegadaTexto: terminada_HoraChegadaTexto,
                                    tipoDeslocacao: terminada_TipoDeslocacao,
                                    codigoTipoKms: terminada_CodigoTipoKms,
                                    matricula: terminada_Matricula,
                                    deslocacaoForaConcelho: terminada_DeslocacaoForaConcelho,
                                    terminada: terminada_Terminada,
                                    estado: terminada_Estado,
                                    criadoPor: terminada_CriadoPor,
                                    codigoRegiao: terminada_CodigoRegiao,
                                    codigoAreaFuncional: terminada_CodigoAreaFuncional,
                                    codigoCentroResponsabilidade: terminada_CodigoCentroResponsabilidade,
                                    validado: terminada_Validado,
                                    validadores: terminada_Validadores,
                                    validador: terminada_Validador,
                                    dataValidacaoTexto: terminada_DataValidacaoTexto,
                                    horaValidacaoTexto: terminada_HoraValidacaoTexto,
                                    integradoresEmRH: terminada_IntegradoresEmRH,
                                    integradorEmRH: terminada_IntegradorEmRH,
                                    dataIntegracaoEmRHTexto: terminada_DataIntegracaoEmRHTexto,
                                    horaIntegracaoEmRHTexto: terminada_HoraIntegracaoEmRHTexto,
                                    integradoresEmRHKM: terminada_IntegradoresEmRHKM,
                                    integradorEmRHKM: terminada_IntegradorEmRHKM,
                                    dataIntegracaoEmRHKMTexto: terminada_DataIntegracaoEmRHKMTexto,
                                    horaIntegracaoEmRHKMTexto: terminada_HoraIntegracaoEmRHKMTexto,
                                    custoTotalAjudaCusto: terminada_CustoTotalAjudaCusto,
                                    custoTotalHoras: terminada_CustoTotalHoras,
                                    custoTotalKM: terminada_CustoTotalKM,
                                    numTotalKM: terminada_NumTotalKM,
                                    observacoes: terminada_Observacoes
                                });
                                ajax_request.generateRequest();
                            }
                        });
                    }
                    else {
                        ajax_ready.generateRequest();
                    }
                },

                _validarFolhaDeHoras: function () {
                    //debugger;
                    if (this._validateFolhaHoras()) {
                        if (this.$.tipoDeslocacao.value == 1) {
                            if (this.$.matricula.validate() & this.$.matricula.value != "") {
                                this.$.validarfolhadehoras_ajax.body = JSON.stringify(this.data);
                                this.$.validarfolhadehoras_ajax.generateRequest();
                            }
                            else {
                                this._showErrorMessage("Falta preencher o campo Matrícula.");
                            }
                        }
                        else {
                            this.$.validarfolhadehoras_ajax.body = JSON.stringify(this.data);
                            this.$.validarfolhadehoras_ajax.generateRequest();
                        }
                    }
                },

                _integrarEmRH: function () {
                    //debugger;
                    if (this._validateFolhaHoras()) {
                        if (this.$.integradorEmRH.value == null) {
                            if (this.$.tipoDeslocacao.value == 1) {
                                if (this.$.matricula.validate() & this.$.matricula.value != "") {
                                    this.$.integraremrhfolhadehoras_ajax.body = JSON.stringify(this.data);
                                    this.$.integraremrhfolhadehoras_ajax.generateRequest();
                                }
                                else {
                                    this._showErrorMessage("Falta preencher o campo Matrícula.");
                                }
                            }
                            else {
                                this.$.integraremrhfolhadehoras_ajax.body = JSON.stringify(this.data);
                                this.$.integraremrhfolhadehoras_ajax.generateRequest();
                            }
                        }
                        else {
                            this._showErrorMessage("A Integração da Ajuda de Custo já foi feita.");
                        }
                    }
                },

                _integrarEmRHKM: function () {
                    //debugger;
                    if (this._validateFolhaHoras()) {
                        if (this.$.integradorEmRHKM.value == null) {
                            if (this.$.tipoDeslocacao.value == 1) {
                                if (this.$.matricula.validate() & this.$.matricula.value != "") {
                                    this.$.integraremrhkmfolhadehoras_ajax.body = JSON.stringify(this.data);
                                    this.$.integraremrhkmfolhadehoras_ajax.generateRequest();
                                }
                                else {
                                    this._showErrorMessage("Falta preencher o campo Matrícula.");
                                }
                            }
                            else {
                                this.$.integraremrhkmfolhadehoras_ajax.body = JSON.stringify(this.data);
                                this.$.integraremrhkmfolhadehoras_ajax.generateRequest();
                            }
                        }
                        else {
                            this._showErrorMessage("A Integração dos km já foi feita.");
                        }
                    }
                },



                //PERCURSO
                _createPercurso: function () {
                    //debugger;
                    if (this.$.projetoNo.value != "") {
                        if (this.$.empregadoNo.validate() & this.$.empregadoNo.value != "") {
                            if (this.$.codigoTipoKms.validate() & this.$.codigoTipoKms.value != "") {
                                if (this.$.percursoOrigem.validate() & this.$.percursoOrigem.value != "") {
                                    if (this.$.percursoDestino.validate() & this.$.percursoDestino.value != "") {
                                        if (this.$.percursoDataViagem.validate() & this.$.percursoDataViagem.value != "") {
                                            if (this._PercursoDataValidar()) {
                                                this.$.page_createpercurso_ajax.body = JSON.stringify({
                                                    noFolhaHoras: this.$.folhaDeHorasNo.value,
                                                    codTipoCusto: this.$.codigoTipoKms.value,
                                                    codOrigem: this.$.percursoOrigem.value,
                                                    codDestino: this.$.percursoDestino.value,
                                                    dataDespesa: this.$.percursoDataViagem.value,
                                                    funcionario: this.$.empregadoNo.value,
                                                    codRegiao: this.$.codigoRegiao.value,
                                                    codArea: this.$.codigoAreaFuncional.value,
                                                    codCresp: this.$.codigoCentroResponsabilidade.value,
                                                    matricula: this.$.matricula.value
                                                });
                                                //this.$.page_createpercurso_ajax.generateRequest();
                                                //this.$.tabPercurso.clearCache();

                                                this.$.page_updatefolhadehoras_ajax.body = JSON.stringify(this.data);

                                                var update = this.$.page_updatefolhadehoras_ajax.generateRequest();
                                                var linha = this.$.page_createpercurso_ajax.generateRequest();

                                                Promise.all([linha.completes, update.completes]).then(function (requests) {
                                                })

                                                this.$.tabPercurso.clearCache();
                                            }
                                            else {
                                                this._showErrorMessage('O campo Data Viagem tem que estar contido no período de tempo do Cabeçalho.');
                                            }
                                        }
                                        else {
                                            this._showErrorMessage('É obrigatório preencher o campo Data Despesa.');
                                        }
                                    }
                                    else {
                                        this._showErrorMessage('É obrigatório preencher o campo Código Destino.');
                                    }
                                }
                                else {
                                    this._showErrorMessage('É obrigatório preencher o campo Código Origem.');
                                }
                            }
                            else {
                                this._showErrorMessage('É obrigatório preencher o campo Cód. Tipo km.');
                            }
                        }
                        else {
                            this._showErrorMessage('É obrigatório preencher o campo Nº Empregado.');
                        }
                    }
                    else {
                        this._showErrorMessage('É obrigatório preencher o campo Nº Ordem/Projecto.');
                    }
                },

                _deletePercurso: function (e) {
                    //debugger;
                    var index = this.data.folhaDeHorasPercurso.indexOf(e.model.item);
                    var percursoFH = this.$.folhaDeHorasNo.value;
                    var percursoNoLinha = e.model.item.noLinha;
                    var ajax_request = this.$.page_deletepercurso_ajax;

                    this.$.page_updatefolhadehoras_ajax.body = JSON.stringify(this.data);
                    this.$.page_updatefolhadehoras_ajax.generateRequest();

                    bootbox.confirm({
                        message: "Tem a certeza que pretende remover o Percurso?",
                        buttons: {
                            confirm: {
                                label: 'Sim',
                                className: 'btn-success'
                            },
                            cancel: {
                                label: 'Não',
                                className: 'btn-danger'
                            }
                        },
                        callback: function (deletePercurso) {
                            if (deletePercurso) {
                                ajax_request.body = JSON.stringify({
                                    noFolhaHoras: percursoFH,
                                    noLinha: percursoNoLinha
                                });
                                ajax_request.generateRequest();

                                this.$.tabPercurso.clearCache();
                            }
                        }
                    });
                },

                //_updatePercurso: function () {
                //    //debugger;
                //    this.$.page_updatepercurso_ajax.body = JSON.stringify(this.data);
                //    this.$.page_updatepercurso_ajax.generateRequest();
                //    this.$.tabPercurso.clearCache();
                //},

                _updateLinhaPercurso: function (e) {
                    //debugger;
                    var index = this.data.folhaDeHorasPercurso.indexOf(e.model.item);

                    this.$.page_updatelinhapercurso_ajax.body = JSON.stringify({
                        noFolhaHoras: this.$.folhaDeHorasNo.value,
                        noLinha: e.model.item.noLinha,
                        codOrigem: e.model.item.codOrigem,
                        codDestino: e.model.item.codDestino,
                        dataDespesa: e.model.item.dataDespesaTexto,
                        observacao: e.model.item.observacao,
                        distancia: e.model.item.distancia,
                        custoUnitario: e.model.item.custoUnitario
                    });
                    this.$.page_updatelinhapercurso_ajax.generateRequest();
                    this.$.tabAjuda.clearCache();
                },

                _PercursoDataValidar: function () {
                    //debugger;
                    if (this.$.percursoDataViagem.value != undefined & this.$.dataPartidaTexto.value != "" & this.$.dataChegadaTexto.value != "") {
                        if (this.$.percursoDataViagem.validate() & this.$.dataPartidaTexto.validate() & this.$.dataChegadaTexto.validate()) {
                            var myDataPartida = new Date(this.$.dataPartidaTexto.value);
                            var myDataChegada = new Date(this.$.dataChegadaTexto.value);
                            var myDataPercurso = new Date(this.$.percursoDataViagem.value);

                            if (myDataPercurso < myDataPartida) {
                                this._showErrorMessage('O campo Data Viagem tem que ser superior ou igual ao campo Data Inicio do Cabeçalho.');
                                return false;
                            }
                            if (myDataPercurso > myDataChegada) {
                                this._showErrorMessage('O campo Data Viagem tem que ser inferior ou igual ao campo Data Fim do Cabeçalho.');
                                return false;
                            }

                            return true;
                        }
                        return false;
                    }
                    return false;
                },



                //AJUDA
                _createAjuda: function () {
                    //debugger;
                    if (this.$.projetoNo.value != "") {
                        if (this.$.empregadoNo.validate() & this.$.empregadoNo.value != "") {
                            if (this.$.ajudaTipoCusto.validate() & this.$.ajudaTipoCusto.value != "") {
                                if (this.$.ajudaCodigoTipoCusto.validate() & this.$.ajudaCodigoTipoCusto.value != "") {
                                    if (this.$.ajudaQuantidade.validate() & this.$.ajudaQuantidade.value != "") {
                                        if (this.$.ajudaCustoUnitario.validate() & this.$.ajudaCustoUnitario.value != "") {
                                            if (this.$.ajudaPrecoUnitario.validate() & this.$.ajudaPrecoUnitario.value != "") {
                                                if (this.$.ajudaDataDespesa.validate() & this.$.ajudaDataDespesa.value != "") {
                                                    if (this._AjudaDataValidar()) {
                                                        if (this._AjudaQuantidadeValidar()) {
                                                            if (this._AjudaCustoUnitarioValidar()) {
                                                                if (this._AjudaPrecoUnitarioValidar()) {
                                                                    this.$.page_createajuda_ajax.body = JSON.stringify({
                                                                        noFolhaHoras: this.$.folhaDeHorasNo.value,
                                                                        tipoCusto: parseInt(this.$.ajudaTipoCusto.value),
                                                                        codTipoCusto: this.$.ajudaCodigoTipoCusto.value,
                                                                        quantidade: parseFloat(this.$.ajudaQuantidade.value),
                                                                        custoUnitario: parseFloat(this.$.ajudaCustoUnitario.value),
                                                                        precoUnitario: parseFloat(this.$.ajudaPrecoUnitario.value),
                                                                        dataDespesa: this.$.ajudaDataDespesa.value,
                                                                        observacao: this.$.ajudaJustificacao.value,
                                                                        funcionario: this.$.empregadoNo.value,
                                                                        codRegiao: this.$.codigoRegiao.value,
                                                                        codArea: this.$.codigoAreaFuncional.value,
                                                                        codCresp: this.$.codigoCentroResponsabilidade.value
                                                                    });
                                                                    //this.$.page_createajuda_ajax.generateRequest();
                                                                    //this.$.tabAjuda.clearCache();

                                                                    this.$.page_updatefolhadehoras_ajax.body = JSON.stringify(this.data);

                                                                    var update = this.$.page_updatefolhadehoras_ajax.generateRequest();
                                                                    var linha = this.$.page_createajuda_ajax.generateRequest();

                                                                    Promise.all([linha.completes, update.completes]).then(function (requests) {
                                                                    })

                                                                    this.$.tabAjuda.clearCache();
                                                                }
                                                                else {
                                                                    this._showErrorMessage('O campo Preço Unitário tem que ser superior ou igual a zero.');
                                                                }
                                                            }
                                                            else {
                                                                this._showErrorMessage('O campo Custo Unitário tem que ser superior ou igual a zero.');
                                                            }
                                                        }
                                                        else {
                                                            this._showErrorMessage('O campo Quantidade tem que ser superior ou igual a zero.');
                                                        }
                                                    }
                                                    else {
                                                        this._showErrorMessage('O campo Data Despesa tem que estar contido no período de tempo do Cabeçalho.');
                                                    }
                                                }
                                                else {
                                                    this._showErrorMessage('É obrigatório preencher o campo Data Despesa.');
                                                }
                                            }
                                            else {
                                                this._showErrorMessage('É obrigatório preencher o campo Preço Unitário.');
                                            }
                                        }
                                        else {
                                            this._showErrorMessage('É obrigatório preencher o campo Custo Unitário.');
                                        }
                                    }
                                    else {
                                        this._showErrorMessage('É obrigatório preencher o campo Quantidade.');
                                    }
                                }
                                else {
                                    this._showErrorMessage('É obrigatório preencher o campo Cód. Tipo Custo.');
                                }
                            }
                            else {
                                this._showErrorMessage('É obrigatório preencher o campo Tipo Custo.');
                            }
                        }
                        else {
                            this._showErrorMessage('É obrigatório preencher o campo Nº Empregado.');
                        }
                    }
                    else {
                        this._showErrorMessage('É obrigatório preencher o campo Nº Ordem/Projecto.');
                    }
                },

                _deleteAjuda: function (e) {
                    //debugger;
                    var index = this.data.folhaDeHorasAjuda.indexOf(e.model.item);
                    var ajudaFH = this.$.folhaDeHorasNo.value;
                    var ajudaNoLinha = e.model.item.noLinha;
                    var ajax_request = this.$.page_deleteajuda_ajax;

                    this.$.page_updatefolhadehoras_ajax.body = JSON.stringify(this.data);
                    this.$.page_updatefolhadehoras_ajax.generateRequest();

                    bootbox.confirm({
                        message: "Tem a certeza que pretende remover a Ajuda?",
                        buttons: {
                            confirm: {
                                label: 'Sim',
                                className: 'btn-success'
                            },
                            cancel: {
                                label: 'Não',
                                className: 'btn-danger'
                            }
                        },
                        callback: function (deleteAjuda) {
                            if (deleteAjuda) {
                                ajax_request.body = JSON.stringify({
                                    noFolhaHoras: ajudaFH,
                                    noLinha: ajudaNoLinha
                                });
                                ajax_request.generateRequest();
                                this.$.tabAjuda.clearCache();
                            }
                        }
                    });
                },

                //_updateAjuda: function () {
                //    //debugger;
                //    this.$.page_updateajuda_ajax.body = JSON.stringify(this.data);
                //    this.$.page_updateajuda_ajax.generateRequest();
                //    this.$.tabAjuda.clearCache();
                //},

                _updateLinhaAjuda: function (e) {
                    //debugger;
                    var index = this.data.folhaDeHorasAjuda.indexOf(e.model.item);

                    this.$.page_updatelinhaajuda_ajax.body = JSON.stringify({
                        noFolhaHoras: this.$.folhaDeHorasNo.value,
                        noLinha: e.model.item.noLinha,
                        tipoCusto: e.model.item.tipoCusto,
                        codTipoCusto: e.model.item.codTipoCusto,
                        quantidade: e.model.item.quantidade,
                        custoUnitario: e.model.item.custoUnitario,
                        custoTotal: e.model.item.custoTotal,
                        precoUnitario: e.model.item.precoUnitario,
                        precoVenda: e.model.item.precoVenda,
                        dataDespesa: e.model.item.dataDespesaTexto,
                        observacao: e.model.item.observacao
                    });
                    this.$.page_updatelinhaajuda_ajax.generateRequest();
                    this.$.tabAjuda.clearCache();
                },

                _AjudaDataValidar: function () {
                    //debugger;
                    if (this.$.ajudaDataDespesa.value != undefined & this.$.dataPartidaTexto.value != "" & this.$.dataChegadaTexto.value != "") {
                        if (this.$.ajudaDataDespesa.validate() & this.$.dataPartidaTexto.validate() & this.$.dataChegadaTexto.validate()) {
                            var myDataPartida = new Date(this.$.dataPartidaTexto.value);
                            var myDataChegada = new Date(this.$.dataChegadaTexto.value);
                            var myDataAjuda = new Date(this.$.ajudaDataDespesa.value);

                            if (myDataAjuda < myDataPartida) {
                                this._showErrorMessage('O campo Data Despesa tem que ser superior ou igual ao campo Data Inicio do Cabeçalho.');
                                return false;
                            }
                            if (myDataAjuda > myDataChegada) {
                                this._showErrorMessage('O campo Data Despesa tem que ser inferior ou igual ao campo Data Fim do Cabeçalho.');
                                return false;
                            }

                            return true;
                        }
                        return false;
                    }
                    return false;
                },

                _AjudaQuantidadeValidar: function () {
                    //debugger;
                    if (this.$.ajudaQuantidade.value != "") {
                        var quant = parseInt(this.$.ajudaQuantidade.value);
                        if (quant < 0) {
                            this._showErrorMessage('O campo Quantidade tem que ser superior ou igual a zero.');
                            return false;
                        }
                        return true;
                    }
                    return false;
                },

                _AjudaCustoUnitarioValidar: function () {
                    //debugger;
                    if (this.$.ajudaCustoUnitario.value != "") {
                        var custo = parseInt(this.$.ajudaCustoUnitario.value);
                        if (custo < 0) {
                            this._showErrorMessage('O campo Custo Unitário tem que ser superior ou igual a zero.');
                            return false;
                        }
                        return true;
                    }
                    return false;
                },

                _AjudaPrecoUnitarioValidar: function () {
                    //debugger;
                    if (this.$.ajudaPrecoUnitario.value != "") {
                        var preco = parseInt(this.$.ajudaPrecoUnitario.value);
                        if (preco < 0) {
                            this._showErrorMessage('O campo Preço Unitário tem que ser superior ou igual a zero.');
                            return false;
                        }
                        return true;
                    }
                    return false;
                },


                //AJUDAS DE CUSTO
                _calcularAjudasCusto: function () {
                    //debugger;
                    if (this._validateFolhaHoras()) {
                        if (this.$.tipoDeslocacao.value == 1) {
                            if (this.$.matricula.validate() & this.$.matricula.value != "") {
                                this.$.page_calcularajudascusto_ajax.body = JSON.stringify(this.data);
                                this.$.page_calcularajudascusto_ajax.generateRequest();
                                this.$.tabAjuda.clearCache();
                            }
                            else {
                                this._showErrorMessage("Falta preencher o campo Matrícula.");
                            }
                        }
                        else {
                            this.$.page_calcularajudascusto_ajax.body = JSON.stringify(this.data);
                            this.$.page_calcularajudascusto_ajax.generateRequest();
                            this.$.tabAjuda.clearCache();
                        }
                    }
                },


                //MAODEOBRA
                _createMaoDeObra: function () {
                    //debugger;
                    if (this.$.empregadoNo.validate() & this.$.empregadoNo.value != "") {
                        if (this.$.maoDeObraDate.validate() & this.$.maoDeObraDate.value != "") {
                            if (this.$.maoDeObraProjetoNo.value != "") {
                                if (this.$.maoDeObraCodigoTipoTrabalho.validate() & this.$.maoDeObraCodigoTipoTrabalho.value != "") {
                                    if (this.$.maoDeObraHoraInicio.validate() & this.$.maoDeObraHoraInicio.value != "") {
                                        if (this.$.maoDeObraHoraFim.validate() & this.$.maoDeObraHoraFim.value != "") {
                                            if (this._MaoDeObraDataValidar() & this._MaoDeObraHoraInicioValidar() & this._MaoDeObraHoraFimValidar()) {
                                                this.$.page_createmaodeobra_ajax.body = JSON.stringify({
                                                    folhaDeHorasNo: this.$.folhaDeHorasNo.value,
                                                    date: this.$.maoDeObraDate.value,
                                                    projetoNo: this.$.maoDeObraProjetoNo.value,
                                                    empregadoNo: this.$.empregadoNo.value,
                                                    codigoRegiao: this.$.codigoRegiao.value,
                                                    codigoArea: this.$.codigoAreaFuncional.value,
                                                    codigoCentroResponsabilidade: this.$.codigoCentroResponsabilidade.value,
                                                    codigoTipoTrabalho: this.$.maoDeObraCodigoTipoTrabalho.value,
                                                    horaInicio: this.$.maoDeObraHoraInicio.value,
                                                    horarioAlmoco: (this.$.maoDeObraHorarioAlmoco.value == "on" ? true : false),
                                                    horaFim: this.$.maoDeObraHoraFim.value,
                                                    horarioJantar: (this.$.maoDeObraHorarioJantar.value == "on" ? true : false)
                                                });
                                                //this.$.page_createmaodeobra_ajax.generateRequest();
                                                //this.$.tabMaoDeObra.clearCache();

                                                this.$.page_updatefolhadehoras_ajax.body = JSON.stringify(this.data);

                                                var update = this.$.page_updatefolhadehoras_ajax.generateRequest();
                                                var linha = this.$.page_createmaodeobra_ajax.generateRequest();

                                                Promise.all([linha.completes, update.completes]).then(function (requests) {
                                                })

                                                this.$.tabMaoDeObra.clearCache();
                                            }
                                            else {
                                                this._showErrorMessage('Os campos Data e Hora tem que estar contido no período de tempo do Cabeçalho.');
                                            }
                                        }
                                        else {
                                            this._showErrorMessage('É obrigatório preencher o campo Hora de Fim.');
                                        }
                                    }
                                    else {
                                        this._showErrorMessage('É obrigatório preencher o campo Hora de Início.');
                                    }
                                }
                                else {
                                    this._showErrorMessage('É obrigatório preencher o campo Tipo Trabalho.');
                                }
                            }
                            else {
                                this._showErrorMessage('É obrigatório preencher o campo Nº Obra.');
                            }
                        }
                        else {
                            this._showErrorMessage('É obrigatório preencher o campo Nº Data.');
                        }
                    }
                    else {
                        this._showErrorMessage('É obrigatório preencher o campo Nº Empregado.');
                    }
                },

                _deleteMaoDeObra: function (e) {
                    //debugger;
                    var index = this.data.folhaDeHorasMaoDeObra.indexOf(e.model.item);
                    var maoDeObraFH = this.$.folhaDeHorasNo.value;
                    var maoDeObraNoLinha = e.model.item.linhaNo;
                    var ajax_request = this.$.page_deletemaodeobra_ajax;

                    this.$.page_updatefolhadehoras_ajax.body = JSON.stringify(this.data);
                    this.$.page_updatefolhadehoras_ajax.generateRequest();

                    bootbox.confirm({
                        message: "Tem a certeza que pretende remover a Mão de Obra?",
                        buttons: {
                            confirm: {
                                label: 'Sim',
                                className: 'btn-success'
                            },
                            cancel: {
                                label: 'Não',
                                className: 'btn-danger'
                            }
                        },
                        callback: function (deleteMaoDeObra) {
                            if (deleteMaoDeObra) {
                                ajax_request.body = JSON.stringify({
                                    folhaDeHorasNo: maoDeObraFH,
                                    linhaNo: maoDeObraNoLinha
                                });
                                ajax_request.generateRequest();
                                this.$.tabMaoDeObra.clearCache();
                            }
                        }
                    });
                },

                //_updateMaoDeObra: function () {
                //    //debugger;
                //    this.$.page_updatemaodeobra_ajax.body = JSON.stringify(this.data);
                //    this.$.page_updatemaodeobra_ajax.generateRequest();
                //    this.$.tabMaoDeObra.clearCache();
                //},

                _updateLinhaMaoDeObra: function (e) {
                    //debugger;
                    var index = this.data.folhaDeHorasMaoDeObra.indexOf(e.model.item);

                    this.$.page_updatelinhamaodeobra_ajax.body = JSON.stringify({
                        folhaDeHorasNo: this.$.folhaDeHorasNo.value,
                        linhaNo: e.model.item.linhaNo,
                        date: e.model.item.dateTexto,
                        projetoNo: e.model.item.projetoNo,
                        empregadoNo: this.$.empregadoNo.value,
                        codigoTipoTrabalho: e.model.item.codigoTipoTrabalho,
                        horaInicio: e.model.item.horaInicioTexto,
                        horarioAlmoco: e.model.item.horarioAlmoco,
                        horaFim: e.model.item.horaFimTexto,
                        horarioJantar: e.model.item.horarioJantar,
                        codigoFamiliaRecurso: e.model.item.codigoFamiliaRecurso,
                        noDeHoras: e.model.item.horasNoTexto,
                        custoUnitárioDireto: e.model.item.custoUnitarioDireto,
                        codigoRegiao: this.$.codigoRegiao.value,
                        codigoAreaFuncional: this.$.codigoAreaFuncional.value,
                        codigoCentroResponsabilidade: this.$.codigoCentroResponsabilidade.value,
                        precoTotal: e.model.item.precoTotal,
                        descricao: e.model.item.descricao
                    });
                    this.$.page_updatelinhamaodeobra_ajax.generateRequest();
                    this.$.tabMaoDeObra.clearCache();
                },

                _MaoDeObraData: function () {
                    //debugger;
                    if (this.$.maoDeObraDate.value != "") {
                        this.$.maoDeObraProjetoNo.value = this.$.projetoNo.value;
                        this.$.maoDeObraCodigoTipoTrabalho.value = "";
                        this.$.maoDeObraHoraInicio.value = "00:00";
                        this.$.maoDeObraHorarioAlmoco.value = "on";
                        this.$.maoDeObraHoraFim.value = "00:00";
                        this.$.maoDeObraHorarioJantar.value = "on"
                    }
                    else {
                        this.$.maoDeObraProjetoNo.value = "";
                        this.$.maoDeObraCodigoTipoTrabalho.value = "";
                        this.$.maoDeObraHoraInicio.value = "";
                        this.$.maoDeObraHorarioAlmoco.value = "off";
                        this.$.maoDeObraHoraFim.value = "";
                        this.$.maoDeObraHorarioJantar.value = "off"
                    }
                },

                _MaoDeObraDataValidar: function () {
                    //debugger;
                    if (this.$.maoDeObraDate.value != undefined & this.$.dataPartidaTexto.value != "" & this.$.dataChegadaTexto.value != "") {
                        if (this.$.maoDeObraDate.validate() & this.$.dataPartidaTexto.validate() & this.$.dataChegadaTexto.validate()) {
                            var myDataPartida = new Date(this.$.dataPartidaTexto.value);
                            var myDataChegada = new Date(this.$.dataChegadaTexto.value);
                            var myDataMaoDeObra = new Date(this.$.maoDeObraDate.value);

                            if (myDataMaoDeObra < myDataPartida) {
                                this._showErrorMessage('O campo Data tem que ser superior ou igual ao campo Data Inicio do Cabeçalho.');
                                return false;
                            }
                            if (myDataMaoDeObra > myDataChegada) {
                                this._showErrorMessage('O campo Data tem que ser inferior ou igual ao campo Data Fim do Cabeçalho.');
                                return false;
                            }

                            if (this.$.maoDeObraProjetoNo.value == undefined) {
                                this.$.maoDeObraProjetoNo.value = this.$.projetoNo.value;
                            }
                            if (this.$.maoDeObraCodigoTipoTrabalho.value == "") {
                                this.$.maoDeObraCodigoTipoTrabalho.value = "";
                            }
                            if (this.$.maoDeObraHoraInicio.value == "") {
                                this.$.maoDeObraHoraInicio.value = this.$.horaPartidaTexto.value;;
                            }
                            if (this.$.maoDeObraHorarioAlmoco.value == undefined) {
                                this.$.maoDeObraHorarioAlmoco.value = "on";
                            }
                            if (this.$.maoDeObraHoraFim.value == "") {
                                this.$.maoDeObraHoraFim.value = this.$.horaChegadaTexto.value;;
                            }
                            if (this.$.maoDeObraHorarioJantar.value == undefined) {
                                this.$.maoDeObraHorarioJantar.value = "on"
                            }
                            return true;
                        }
                        return false;
                    }
                    return false;
                },

                _MaoDeObraHoraInicioValidar: function () {
                    //debugger;
                    if (this.$.maoDeObraDate.value != undefined & this.$.dataPartidaTexto.value != "" & this.$.dataChegadaTexto.value != "" &
                        this.$.maoDeObraHoraInicio.value != "" & this.$.horaPartidaTexto.value != "" & this.$.horaChegadaTexto.value != "") {

                        if (this.$.maoDeObraDate.validate() & this.$.dataPartidaTexto.validate() & this.$.dataChegadaTexto.validate() &
                            this.$.maoDeObraHoraInicio.validate() & this.$.horaPartidaTexto.validate() & this.$.horaChegadaTexto.validate()) {

                            var myDataTimePartida = new Date(this.$.dataPartidaTexto.value + " " + this.$.horaPartidaTexto.value);
                            var myDataTimeChegada = new Date(this.$.dataChegadaTexto.value + " " + this.$.horaChegadaTexto.value);
                            var myDataTimeMaoDeObra = new Date(this.$.maoDeObraDate.value + " " + this.$.maoDeObraHoraInicio.value);

                            if (myDataTimeMaoDeObra < myDataTimePartida) {
                                this._showErrorMessage('O campo Hora de Início tem que ser superior ou igual ao campo Data Inicio do Cabeçalho.');
                                return false;
                            }
                            if (myDataTimeMaoDeObra > myDataTimeChegada) {
                                this._showErrorMessage('O campo Hora de Fim tem que ser inferior ou igual ao campo Data Fim do Cabeçalho.');
                                return false;
                            }

                            return true;
                        }
                        return false;
                    }
                    return false;
                },

                _MaoDeObraHoraFimValidar: function () {
                    //debugger;
                    if (this.$.maoDeObraDate.value != undefined & this.$.dataPartidaTexto.value != "" & this.$.dataChegadaTexto.value != "" &
                        this.$.maoDeObraHoraFim.value != "" & this.$.horaPartidaTexto.value != "" & this.$.horaChegadaTexto.value != "") {

                        if (this.$.maoDeObraDate.validate() & this.$.dataPartidaTexto.validate() & this.$.dataChegadaTexto.validate() &
                            this.$.maoDeObraHoraFim.validate() & this.$.horaPartidaTexto.validate() & this.$.horaChegadaTexto.validate()) {

                            var myDataTimePartida = new Date(this.$.dataPartidaTexto.value + " " + this.$.horaPartidaTexto.value);
                            var myDataTimeChegada = new Date(this.$.dataChegadaTexto.value + " " + this.$.horaChegadaTexto.value);
                            var myDataTimeMaoDeObra = new Date(this.$.maoDeObraDate.value + " " + this.$.maoDeObraHoraFim.value);

                            if (myDataTimeMaoDeObra < myDataTimePartida) {
                                this._showErrorMessage('O campo Hora de Fim tem que ser superior ou igual ao campo Data Inicio do Cabeçalho.');
                                return false;
                            }
                            if (myDataTimeMaoDeObra > myDataTimeChegada) {
                                this._showErrorMessage('O campo Hora de Fim tem que ser inferior ou igual ao campo Data Fim do Cabeçalho.');
                                return false;
                            }

                            return true;
                        }
                        return false;
                    }
                    return false;
                },

                _MaoDeObraHoraInicioFim: function () {
                    //debugger;
                    if ((this.$.maoDeObraHoraInicio.validate() & this.$.maoDeObraHoraInicio.value != "" & this.$.maoDeObraHoraInicio.value != "00:00") &
                        (this.$.maoDeObraHoraFim.validate() & this.$.maoDeObraHoraFim.value != "" & this.$.maoDeObraHoraFim.value != "00:00")) {
                        this.$.page_maodeobrahorainiciofim_ajax.body = JSON.stringify({
                            folhaDeHorasNo: this.$.folhaDeHorasNo.value,
                            date: this.$.maoDeObraDate.value,
                            projetoNo: this.$.maoDeObraProjetoNo.value,
                            empregadoNo: this.$.empregadoNo.value,
                            codigoTipoTrabalho: parseInt(this.$.maoDeObraCodigoTipoTrabalho.value),
                            horaInicio: this.$.maoDeObraHoraInicio.value,
                            horarioAlmoco: (this.$.maoDeObraHorarioAlmoco.value == "on" ? true : false),
                            horaFim: this.$.maoDeObraHoraFim.value,
                            horarioJantar: (this.$.maoDeObraHorarioJantar.value == "on" ? true : false),
                        });
                        this.$.page_maodeobrahorainiciofim_ajax.generateRequest();
                    }
                    else {
                        this._showErrorMessage('É necessário preencher todos os campos obrigatórios corretamente.');
                    }
                },

                //PRENSENÇAS
                _createPresenca: function () {
                    //debugger;
                    if (this.$.projetoNo.value != "") {
                        if (this.$.empregadoNo.validate() & this.$.empregadoNo.value != "") {
                            if (this.$.presencaDataTexto.validate() & this.$.presencaDataTexto.value != "") {
                                if (this.$.presencaHora1Entrada.validate() & this.$.presencaHora1Entrada.value != "") {
                                    if (this.$.presencaHora1Saida.validate() & this.$.presencaHora1Saida.value != "") {
                                        if (this.$.presencaHora2Entrada.validate() & this.$.presencaHora2Entrada.value != "") {
                                            if (this.$.presencaHora2Saida.validate() & this.$.presencaHora2Saida.value != "") {
                                                if (this._PresencaDataValidar() & this._presencaHora1EntradaValidar() & this._presencaHora1SaidaValidar() & this._presencaHora2EntradaValidar() & this._presencaHora2SaidaValidar()) {
                                                    this.$.page_createpresenca_ajax.body = JSON.stringify({
                                                        folhaDeHorasNo: this.$.folhaDeHorasNo.value,
                                                        data: this.$.presencaDataTexto.value,
                                                        noEmpregado: this.$.empregadoNo.value,
                                                        hora1Entrada: this.$.presencaHora1Entrada.value,
                                                        hora1Saida: this.$.presencaHora1Saida.value,
                                                        hora2Entrada: this.$.presencaHora2Entrada.value,
                                                        hora2Saida: this.$.presencaHora2Saida.value,
                                                        observacoes: this.$.presencaObservacoes.value
                                                    });
                                                    //this.$.page_createpresenca_ajax.generateRequest();
                                                    //this.$.tabPresenca.clearCache();

                                                    this.$.page_updatefolhadehoras_ajax.body = JSON.stringify(this.data);

                                                    var update = this.$.page_updatefolhadehoras_ajax.generateRequest();
                                                    var linha = this.$.page_createpresenca_ajax.generateRequest();

                                                    Promise.all([linha.completes, update.completes]).then(function (requests) {
                                                    })

                                                    this.$.tabPresenca.clearCache();
                                                }
                                                else {
                                                    this._showErrorMessage('Os campos Data e Hora tem que estar contido no período de tempo do Cabeçalho.');
                                                }
                                            }
                                            else {
                                                this._showErrorMessage('É obrigatório preencher o campo 2ª Saída.');
                                            }
                                        }
                                        else {
                                            this._showErrorMessage('É obrigatório preencher o campo 2ª Entrada.');
                                        }
                                    }
                                    else {
                                        this._showErrorMessage('É obrigatório preencher o campo 1ª Saída.');
                                    }
                                }
                                else {
                                    this._showErrorMessage('É obrigatório preencher o campo 1ª Entrada.');
                                }
                            }
                            else {
                                this._showErrorMessage('É obrigatório preencher o campo Data.');
                            }
                        }
                        else {
                            this._showErrorMessage('É obrigatório preencher o campo Nº Empregado.');
                        }
                    }
                    else {
                        this._showErrorMessage('É obrigatório preencher o campo Nº Ordem/Projecto.');
                    }
                },

                _deletePresenca: function (e) {
                    //debugger;
                    var index = this.data.folhaDeHorasPresenca.indexOf(e.model.item);
                    var presencaFH = this.$.folhaDeHorasNo.value;
                    var presencaData = e.model.item.dataTexto;
                    var ajax_request = this.$.page_deletepresenca_ajax;

                    this.$.page_updatefolhadehoras_ajax.body = JSON.stringify(this.data);
                    this.$.page_updatefolhadehoras_ajax.generateRequest();

                    bootbox.confirm({
                        message: "Tem a certeza que pretende remover a Presença?",
                        buttons: {
                            confirm: {
                                label: 'Sim',
                                className: 'btn-success'
                            },
                            cancel: {
                                label: 'Não',
                                className: 'btn-danger'
                            }
                        },
                        callback: function (deletePresenca) {
                            if (deletePresenca) {
                                ajax_request.body = JSON.stringify({
                                    folhaDeHorasNo: presencaFH,
                                    data: presencaData
                                });
                                ajax_request.generateRequest();
                                this.$.tabPresenca.clearCache();
                            }
                        }
                    });
                },

                //_updatePresenca: function () {
                //    //debugger;
                //    this.$.page_updatepresenca_ajax.body = JSON.stringify(this.data);
                //    this.$.page_updatepresenca_ajax.generateRequest();
                //    this.$.tabPresenca.clearCache();
                //},

                _updateLinhaPresenca: function (e) {
                    //debugger;
                    var index = this.data.folhaDeHorasPresenca.indexOf(e.model.item);

                    this.$.page_updatelinhapresenca_ajax.body = JSON.stringify({
                        folhaDeHorasNo: this.$.folhaDeHorasNo.value,
                        data: e.model.item.dataTexto,
                        noEmpregado: this.$.empregadoNo.value,
                        hora1Entrada: e.model.item.hora1Entrada,
                        hora1Saida: e.model.item.hora1Saida,
                        hora2Entrada: e.model.item.hora2Entrada,
                        hora2Saida: e.model.item.hora2Saida,
                        observacoes: e.model.item.observacoes
                    });
                    this.$.page_updatelinhapresenca_ajax.generateRequest();
                    this.$.tabPresenca.clearCache();
                },

                _PresencaData: function () {
                    //debugger;
                    if (this.$.presencaDataTexto.value != "") {
                        this.$.presencaHora1Entrada.value = "00:00";
                        this.$.presencaHora1Saida.value = "00:00";
                        this.$.presencaHora2Entrada.value = "00:00";
                        this.$.presencaHora2Saida.value = "00:00";
                        this.$.presencaObservacoes.value = "";
                    }
                    else {
                        this.$.presencaHora1Entrada.value = "00:00";
                        this.$.presencaHora1Saida.value = "00:00";
                        this.$.presencaHora2Entrada.value = "00:00";
                        this.$.presencaHora2Saida.value = "00:00";
                        this.$.presencaObservacoes.value = "";
                    }
                },

                _PresencaVerificarHoras: function () {
                    //debugger;
                    if ((this.$.presencaHora1Entrada.validate() & this.$.presencaHora1Entrada.value != "" & this.$.presencaHora1Entrada.value != "00:00") &
                        (this.$.presencaHora1Saida.validate() & this.$.presencaHora1Saida.value != "" & this.$.presencaHora1Saida.value != "00:00") &
                        (this.$.presencaHora2Entrada.validate() & this.$.presencaHora2Entrada.value != "" & this.$.presencaHora2Entrada.value != "00:00") &
                        (this.$.presencaHora2Saida.validate() & this.$.presencaHora2Saida.value != "" & this.$.presencaHora2Saida.value != "00:00")) {

                        var Hora1Entrada = Date.parseExact(new Date(), this.$.presencaHora1Entrada.value);
                        var Hora1Saida = Date.parseExact(new Date(), this.$.presencaHora1Saida.value);
                        var Hora2Entrada = Date.parseExact(new Date(), this.$.presencaHora2Entrada.value);
                        var Hora2Saida = Date.parseExact(new Date(), this.$.presencaHora2Saida.value);

                        if ((Hora1Entrada > Hora1Saida) | (Hora1Entrada > Hora2Entrada) | (Hora1Entrada > Hora2Saida)) {
                            this._showErrorMessage('Ocorreu um erro ao criar a Folha de Horas.');
                        }

                    }
                },

                _PresencaDataValidar: function () {
                    //debugger;
                    if (this.$.presencaDataTexto.value != undefined & this.$.dataPartidaTexto.value != "" & this.$.dataChegadaTexto.value != "") {
                        if (this.$.presencaDataTexto.validate() & this.$.dataPartidaTexto.validate() & this.$.dataChegadaTexto.validate()) {
                            var myDataPartida = new Date(this.$.dataPartidaTexto.value);
                            var myDataChegada = new Date(this.$.dataChegadaTexto.value);
                            var myDataPresenca = new Date(this.$.presencaDataTexto.value);

                            if (myDataPresenca < myDataPartida) {
                                this._showErrorMessage('O campo Data tem que ser superior ou igual ao campo Data Inicio do Cabeçalho.');
                                return false;
                            }
                            if (myDataPresenca > myDataChegada) {
                                this._showErrorMessage('O campo Data tem que ser inferior ou igual ao campo Data Fim do Cabeçalho.');
                                return false;
                            }

                            if (this.$.presencaHora1Entrada.value == "") {
                                this.$.presencaHora1Entrada.value = this.$.horaPartidaTexto.value; //"00:00";
                            }
                            if (this.$.presencaHora1Saida.value == "") {
                                this.$.presencaHora1Saida.value = "00:00";
                            }
                            if (this.$.presencaHora2Entrada.value == "") {
                                this.$.presencaHora2Entrada.value = "00:00";
                            }
                            if (this.$.presencaHora2Saida.value == "") {
                                this.$.presencaHora2Saida.value = this.$.horaChegadaTexto.value; //"00:00";
                            }
                            if (this.$.presencaObservacoes.value == "") {
                                this.$.presencaObservacoes.value = "";
                            }

                            return true;
                        }
                        return false;
                    }
                    return false;
                },

                _presencaHora1EntradaValidar: function () {
                    //debugger;
                    if (this.$.presencaDataTexto.value != undefined & this.$.dataPartidaTexto.value != "" & this.$.dataChegadaTexto.value != "" &
                        this.$.presencaHora1Entrada.value != "" & this.$.horaPartidaTexto.value != "" & this.$.horaChegadaTexto.value != "") {

                        if (this.$.presencaDataTexto.validate() & this.$.dataPartidaTexto.validate() & this.$.dataChegadaTexto.validate() &
                            this.$.presencaHora1Entrada.validate() & this.$.horaPartidaTexto.validate() & this.$.horaChegadaTexto.validate()) {

                            var myDataTimePartida = new Date(this.$.dataPartidaTexto.value + " " + this.$.horaPartidaTexto.value);
                            var myDataTimeChegada = new Date(this.$.dataChegadaTexto.value + " " + this.$.horaChegadaTexto.value);
                            var myDataTimePresenca = new Date(this.$.presencaDataTexto.value + " " + this.$.presencaHora1Entrada.value);

                            if (myDataTimePresenca < myDataTimePartida) {
                                this._showErrorMessage('O campo 1ª Entrada tem que ser superior ou igual ao campo Data Inicio do Cabeçalho.');
                                return false;
                            }
                            if (myDataTimePresenca > myDataTimeChegada) {
                                this._showErrorMessage('O campo 1ª Entrada tem que ser inferior ou igual ao campo Data Fim do Cabeçalho.');
                                return false;
                            }

                            return true;
                        }
                        return false;
                    }
                    return false;
                },

                _presencaHora1SaidaValidar: function () {
                    //debugger;
                    if (this.$.presencaDataTexto.value != undefined & this.$.dataPartidaTexto.value != "" & this.$.dataChegadaTexto.value != "" &
                        this.$.presencaHora1Saida.value != "" & this.$.horaPartidaTexto.value != "" & this.$.horaChegadaTexto.value != "") {

                        if (this.$.presencaDataTexto.validate() & this.$.dataPartidaTexto.validate() & this.$.dataChegadaTexto.validate() &
                            this.$.presencaHora1Saida.validate() & this.$.horaPartidaTexto.validate() & this.$.horaChegadaTexto.validate()) {

                            var myDataTimePartida = new Date(this.$.dataPartidaTexto.value + " " + this.$.horaPartidaTexto.value);
                            var myDataTimeChegada = new Date(this.$.dataChegadaTexto.value + " " + this.$.horaChegadaTexto.value);
                            var myDataTimePresenca = new Date(this.$.presencaDataTexto.value + " " + this.$.presencaHora1Saida.value);

                            if (myDataTimePresenca < myDataTimePartida) {
                                this._showErrorMessage('O campo 1ª Saída tem que ser superior ou igual ao campo Data Inicio do Cabeçalho.');
                                return false;
                            }
                            if (myDataTimePresenca > myDataTimeChegada) {
                                this._showErrorMessage('O campo 1ª Saída tem que ser inferior ou igual ao campo Data Fim do Cabeçalho.');
                                return false;
                            }

                            return true;
                        }
                        return false;
                    }
                    return false;
                },

                _presencaHora2EntradaValidar: function () {
                    //debugger;
                    if (this.$.presencaDataTexto.value != undefined & this.$.dataPartidaTexto.value != "" & this.$.dataChegadaTexto.value != "" &
                        this.$.presencaHora2Entrada.value != "" & this.$.horaPartidaTexto.value != "" & this.$.horaChegadaTexto.value != "") {

                        if (this.$.presencaDataTexto.validate() & this.$.dataPartidaTexto.validate() & this.$.dataChegadaTexto.validate() &
                            this.$.presencaHora2Entrada.validate() & this.$.horaPartidaTexto.validate() & this.$.horaChegadaTexto.validate()) {

                            var myDataTimePartida = new Date(this.$.dataPartidaTexto.value + " " + this.$.horaPartidaTexto.value);
                            var myDataTimeChegada = new Date(this.$.dataChegadaTexto.value + " " + this.$.horaChegadaTexto.value);
                            var myDataTimePresenca = new Date(this.$.presencaDataTexto.value + " " + this.$.presencaHora2Entrada.value);

                            if (myDataTimePresenca < myDataTimePartida) {
                                this._showErrorMessage('O campo 2ª Entrada tem que ser superior ou igual ao campo Data Inicio do Cabeçalho.');
                                return false;
                            }
                            if (myDataTimePresenca > myDataTimeChegada) {
                                this._showErrorMessage('O campo 2ª Entrada tem que ser inferior ou igual ao campo Data Fim do Cabeçalho.');
                                return false;
                            }

                            return true;
                        }
                        return false;
                    }
                    return false;
                },

                _presencaHora2SaidaValidar: function () {
                    //debugger;
                    if (this.$.presencaDataTexto.value != undefined & this.$.dataPartidaTexto.value != "" & this.$.dataChegadaTexto.value != "" &
                        this.$.presencaHora2Saida.value != "" & this.$.horaPartidaTexto.value != "" & this.$.horaChegadaTexto.value != "") {

                        if (this.$.presencaDataTexto.validate() & this.$.dataPartidaTexto.validate() & this.$.dataChegadaTexto.validate() &
                            this.$.presencaHora2Saida.validate() & this.$.horaPartidaTexto.validate() & this.$.horaChegadaTexto.validate()) {

                            var myDataTimePartida = new Date(this.$.dataPartidaTexto.value + " " + this.$.horaPartidaTexto.value);
                            var myDataTimeChegada = new Date(this.$.dataChegadaTexto.value + " " + this.$.horaChegadaTexto.value);
                            var myDataTimePresenca = new Date(this.$.presencaDataTexto.value + " " + this.$.presencaHora2Saida.value);

                            if (myDataTimePresenca < myDataTimePartida) {
                                this._showErrorMessage('O campo 2ª Saída tem que ser superior ou igual ao campo Data Inicio do Cabeçalho.');
                                return false;
                            }
                            if (myDataTimePresenca > myDataTimeChegada) {
                                this._showErrorMessage('O campo 2ª Saída tem que ser inferior ou igual ao campo Data Fim do Cabeçalho.');
                                return false;
                            }

                            return true;
                        }
                        return false;
                    }
                    return false;
                },

                //RESPONSES PROCESSORS
                _responseProcessor: function (data) {
                    //debugger;
                    var self = this;

                    if (data.detail.status === 200) {
                        if (data.detail.url.indexOf("GetFolhaDeHora") !== -1) {
                            if (this.data.FolhaDeHorasNo == "") {
                                this._isCreate = true;
                            }

                            self._setFieldsEditability(self.data);
                        } else if (data.detail.url.indexOf("Create") !== -1) {
                            this._createResponseProcessor();
                        } else if (data.detail.url.indexOf("Update") !== -1) {
                            this._showMessage('Folha de Horas atualizada com sucesso.')
                        }
                    } else {
                        this._showErrorMessage('Ocorreu um erro ao criar a Folha de Horas.')
                    }
                },

                _createResponseProcessor: function () {
                    //debugger;
                    if (this.data.eReasonCode == 1) {
                        this._isCreate = false;
                        this._showMessage('Folha de Horas criada com sucesso.');
                    } else {
                        this._showErrorMessage(this.data.eMessage);
                    }
                },

                _responseValidatorProcessor: function (data) {
                    //debugger;
                    var self = this;
                    if (data.detail.status === 200) {
                        if (this.validateResponse == "") {
                            this._executeRequest("/FolhasDeHoras/CreateFolhaDeHora", this.data)
                        } else {
                            this._showErrorMessage(data);
                        }
                    }
                },

                _responseDeleteProcessor: function (data) {
                    //debugger;
                    var self = this;
                    if (data.detail.status === 200) {
                        if (this.deletedData.eReasonCode == 1) {
                            this._showErrorMessage('Não é possivel eliminar a Folha de Horas pois este já possui movimentos.');
                        } else {
                            this._showMessage(this.deletedData.eMessage);
                            setTimeout(
                                function () {
                                    window.location.replace("/");
                                }, 2500);
                        }
                    }
                },

                //FOLHA DE HORAS
                _updatefolhadehorasvalidacaoResponse: function (e) {
                    //debugger;
                    var ajax_request = this.$.page_updatefolhadehoras_ajax;
                    ajax_request.body = JSON.stringify(this.data);

                    if (this.FolhaDeHorasUpdatedValidacao == 0) {
                        ajax_request.generateRequest();
                    }
                    else {
                        if (this.FolhaDeHorasUpdatedValidacao == 1) {
                            this._showErrorMessage('O campo Data-Hora Fim não pode ser inferior ao campo Data-Hora Inicio no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 2) {
                            this._showErrorMessage('O campo Data-Hora Inicio não pode ser superior á Data-Hora atual na cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 3) {
                            this._showErrorMessage('O campo Data-Hora Fim não pode ser superior á Data-Hora atual no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 4) {
                            this._showErrorMessage('Existe uma Data Viagem nos Percursos que é inferior á Data Início no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 5) {
                            this._showErrorMessage('Existe uma Data Viagem nos Percursos que é superior á Data Fim no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 6) {
                            this._showErrorMessage('Existe uma Data Despesa nas Ajudas de Custo que é inferior á Data Início no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 7) {
                            this._showErrorMessage('Existe uma Data Despesa nas Ajudas de Custo que é superior á Data Fim no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 8) {
                            this._showErrorMessage('Existe uma Data-Hora Início na Mão de Obra que é inferior á Data-Hora Início no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 9) {
                            this._showErrorMessage('Existe uma Data-Hora Início na Mão de Obra que é superior á Data-Hora Fim no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 10) {
                            this._showErrorMessage('Existe uma Data-Hora Fim na Mão de Obra que é inferior á Data-Hora Início no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 11) {
                            this._showErrorMessage('Existe uma Data-Hora Fim na Mão de Obra que é superior á Data-Hora Fim no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 12) {
                            this._showErrorMessage('Existe uma Data-Hora 1ª Entrada nas Presenças que é inferior á Data-Hora Início no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 13) {
                            this._showErrorMessage('Existe uma Data-Hora 1ª Entrada nas Presenças que é superior á Data-Hora Fim no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 14) {
                            this._showErrorMessage('Existe uma Data-Hora 1ª Saída nas Presenças que é inferior á Data-Hora Início no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 15) {
                            this._showErrorMessage('Existe uma Data-Hora 1ª Saída nas Presenças que é superior á Data-Hora Fim no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 16) {
                            this._showErrorMessage('Existe uma Data-Hora 2ª Entrada nas Presenças que é inferior á Data-Hora Início no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 17) {
                            this._showErrorMessage('Existe uma Data-Hora 2ª Entrada nas Presenças que é superior á Data-Hora Fim no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 18) {
                            this._showErrorMessage('Existe uma Data-Hora 2ª Saída nas Presenças que é inferior á Data-Hora Início no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 19) {
                            this._showErrorMessage('Existe uma Data-Hora 2ª Saída nas Presenças que é superior á Data-Hora Fim no cabeçalho.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 20) {
                            this._showErrorMessage('Falta preencher o campo Nº Folha Horas.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 21) {
                            this._showErrorMessage('Falta preencher o campo Nº Ordem/Projecto.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 22) {
                            this._showErrorMessage('Falta preencher o campo Nº Empregado - Nome.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 23) {
                            this._showErrorMessage('Falta preencher o campo Data Inicio.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 24) {
                            this._showErrorMessage('Falta preencher o campo Hora Início.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 25) {
                            this._showErrorMessage('Falta preencher o campo Data Fim.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 26) {
                            this._showErrorMessage('Falta preencher o campo Hora Fim.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 27) {
                            this._showErrorMessage('Falta preencher o campo Tipo Deslocação.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 28) {
                            this._showErrorMessage('Falta preencher o campo Tipo km.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 29) {
                            this._showErrorMessage('Falta preencher o campo Matrícula.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 30) {
                            this._showErrorMessage('Falta preencher o campo Região.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 31) {
                            this._showErrorMessage('Falta preencher o campo Área Funcional.');
                        }
                        if (this.FolhaDeHorasUpdatedValidacao == 32) {
                            this._showErrorMessage('Falta preencher o campo Centro Respon.');
                        }

                        if (this.FolhaDeHorasUpdatedValidacao == 88) {
                            bootbox.confirm({
                                message: "Já existe uma Folha de Horas para este Empregado neste período de tempo, deseja continuar (Sim/Não)?",
                                buttons: {
                                    confirm: {
                                        label: 'Sim',
                                        className: 'btn-success'
                                    },
                                    cancel: {
                                        label: 'Não',
                                        className: 'btn-danger'
                                    }
                                },
                                callback: function (result) {
                                    if (result) {
                                        ajax_request.generateRequest();
                                    }
                                }
                            });
                        }

                        if (this.FolhaDeHorasUpdatedValidacao == 99) {
                            this._showErrorMessage('Ocorreu um erro.');
                        }
                    }
                },

                _updatefolhadehorasResponse: function (e) {
                    //debugger;
                    var self = this;

                    if (this.FolhaDeHorasUpdated == 0) {
                        this._showMessage('Folha de Horas actualizada com sucesso.');
                        this.$.page_databound_ajax.generateRequest();
                    } else {
                        if (this.FolhaDeHorasUpdated == 1) {
                            this._showErrorMessage('Já existe uma Folha de Horas nesse período de tempo para empregado em questão.');
                        }

                        if (this.FolhaDeHorasUpdated == 2) {
                            this._showErrorMessage('Ocorreu um erro ao actualizar a Folha de Horas.');
                        }

                        if (this.FolhaDeHorasUpdated == 99) {
                            this._showErrorMessage('Ocorreu um erro.');
                        }

                        //setTimeout(
                        //    function () {
                        //        window.location.replace("/");
                        //    }, 2500);
                    }
                },

                _terminarfolhadehorasResponse: function (e) {
                    //debugger;
                    setTimeout(function () {
                        bootbox.hideAll();
                    }, 0);

                    if (this.terminarFolhaDeHoras.eReasonCode == 0 || this.terminarFolhaDeHoras.eReasonCode == 100) {
                        this._showMessage(this.terminarFolhaDeHoras.eMessage);
                        this.$.page_databound_ajax.generateRequest();
                    } else {
                        if (this.terminarFolhaDeHoras.eReasonCode == 1) {
                            this.$.page_databound_ajax.generateRequest();
                        }
                        else {
                            this._showErrorMessage(this.terminarFolhaDeHoras.eMessage);
                        }
                    };
                },

                _validarfolhadehorasResponse: function (e) {
                    //debugger;
                    if (this.validarFolhaDeHoras.eReasonCode == 0 || this.validarFolhaDeHoras.eReasonCode == 100) {
                        this._showMessage(this.validarFolhaDeHoras.eMessage);
                        this.$.page_databound_ajax.generateRequest();
                    } else {
                        this._showErrorMessage(this.validarFolhaDeHoras.eMessage);
                    };
                },

                _integraremrhfolhadehorasResponse: function (e) {
                    //debugger;
                    if (this.integrarEmRHFolhaDeHoras.eReasonCode == 0 || this.integrarEmRHFolhaDeHoras.eReasonCode == 100) {
                        this._showMessage(this.integrarEmRHFolhaDeHoras.eMessage);
                        this.$.page_databound_ajax.generateRequest();
                    } else {
                        this._showErrorMessage(this.integrarEmRHFolhaDeHoras.eMessage);
                    };
                },

                _integraremrhkmfolhadehorasResponse: function (e) {
                    //debugger;
                    if (this.integrarEmRHKMFolhaDeHoras.eReasonCode == 0 || this.integrarEmRHKMFolhaDeHoras.eReasonCode == 100) {
                        this._showMessage(this.integrarEmRHKMFolhaDeHoras.eMessage);
                        this.$.page_databound_ajax.generateRequest();
                    } else {
                        this._showErrorMessage(this.integrarEmRHKMFolhaDeHoras.eMessage);
                    };
                },


                //PERCURSO
                _createPercursoResponse: function (e) {
                    //debugger;
                    if (this.PercursoCreated) {
                        this._showMessage('Adicionado Percurso com sucesso.');
                        this.$.page_databound_ajax.generateRequest();

                        this.$.percursoOrigem.value = "";
                        this.$.percursoDestino.value = "";
                        this.$.percursoDataViagem.value = "";
                    }
                    else {
                        this._showErrorMessage('Ocorreu um erro ao adicionar.');
                    }
                },

                _deletePercursoResponse: function (e) {
                    //debugger;
                    var self = this;

                    setTimeout(function () {
                        bootbox.hideAll();
                    }, 0);

                    if (this.PercursoDeleted) {
                        this._showMessage('Percurso removido com sucesso.');
                        this.$.page_databound_ajax.generateRequest();
                    } else {
                        this._showErrorMessage('Ocorreu um erro ao eliminar Percurso.');
                    }
                },

                _updatePercursoResponse: function (e) {
                    //debugger;
                    if (this.PercursoUpdated) {
                        this._showMessage('Percurso(s) actualizado(s) com sucesso.');
                        this.$.page_databound_ajax.generateRequest();
                    }
                    else {
                        this._showErrorMessage('Ocorreu um erro ao actualizar o(s) Percurso(s).');
                    }
                },

                _updateLinhaPercursoResponse: function (e) {
                    //debugger;
                    if (this.LinhaPercursoUpdated == 0) {
                        this._showMessage('Percurso(s) actualizado(s) com sucesso.');
                    }
                    else {
                        if (this.LinhaPercursoUpdated == 1) {
                            this._showErrorMessage('O valor da Distância Efectuada tem que ser superior ou igual a 0 e inferior a 10 000.');
                        }
                        else {
                            this._showErrorMessage('Ocorreu um erro ao actualizar o Percurso.');
                        }
                    }
                    this.$.page_databound_ajax.generateRequest();
                },

                //AJUDA
                _createAjudaResponse: function (e) {
                    //debugger;
                    if (this.AjudaCreated) {
                        this._showMessage('Adicionada Ajuda com sucesso.');
                        this.$.page_databound_ajax.generateRequest();

                        this.$.ajudaTipoCusto.value = "";
                        this.$.ajudaCodigoTipoCusto.value = "";
                        this.$.ajudaQuantidade.value = "";
                        this.$.ajudaCustoUnitario.value = "";
                        this.$.ajudaPrecoUnitario.value = "";
                        this.$.ajudaDataDespesa.value = "";
                        this.$.ajudaJustificacao.value = "";
                    }
                    else {
                        this._showErrorMessage('Ocorreu um erro ao adicionar.');
                    }
                },

                _deleteAjudaResponse: function (data) {
                    //debugger;
                    var self = this;

                    setTimeout(function () {
                        bootbox.hideAll();
                    }, 0);

                    if (this.AjudaDeleted) {
                        this._showMessage('Ajuda removida com sucesso.');
                        this.$.page_databound_ajax.generateRequest();
                    } else {
                        this._showErrorMessage('Ocorreu um erro ao eliminar Ajuda.');
                    }
                },

                _updateAjudaResponse: function (e) {
                    //debugger;
                    if (this.AjudaUpdated) {
                        this._showMessage('Ajuda(s) actualizada(s) com sucesso.');
                        this.$.page_databound_ajax.generateRequest();
                    }
                    else {
                        this._showErrorMessage('Ocorreu um erro ao actualizar a(s) Ajuda(s).');
                    }
                },

                _updateLinhaAjudaResponse: function (e) {
                    //debugger;
                    if (this.LinhaAjudaUpdated == 0) {
                        this._showMessage('Ajuda actualizada com sucesso.');
                    }
                    else {
                        if (this.LinhaAjudaUpdated == 1) {
                            this._showErrorMessage('O valor da quantidade tem que ser superior ou igual a 0 e inferior a 10 000.');
                        }
                        else {
                            if (this.LinhaAjudaUpdated == 2) {
                                this._showErrorMessage('O valor do Custo Unitário tem que ser superior ou igual a 0.');
                            }
                            else {
                                if (this.LinhaAjudaUpdated == 3) {
                                    this._showErrorMessage('O valor do Preço Unitário tem que ser superior ou igual a 0.');
                                }
                                else {
                                    if (this.LinhaAjudaUpdated == 4) {
                                        this._showErrorMessage('O valor do Preço de Venda tem que ser superior ou igual a 0.');
                                    }
                                    else {
                                        this._showErrorMessage('Ocorreu um erro ao actualizar a Ajuda.');
                                    }
                                }
                            }
                        }
                    }
                    this.$.page_databound_ajax.generateRequest();
                },

                //AJUDA DE CUSTOS
                _updateCalcularAjudasCustoResponse: function (e) {
                    //debugger;
                    if (this.CalcularAjudasCustoUpdated.eReasonCode == 0) {
                        this._showMessage(this.CalcularAjudasCustoUpdated.eMessage);
                        this.$.page_databound_ajax.generateRequest();
                    } else {
                        this._showErrorMessage(this.CalcularAjudasCustoUpdated.eMessage);
                    };

                    //if (this.CalcularAjudasCustoUpdated) {
                    //    this._showMessage('Foi calculado a(s) Ajuda(s) de Custo com sucesso.');
                    //    this.$.page_databound_ajax.generateRequest();
                    //}
                    //else {
                    //    this._showErrorMessage('Ocorreu um erro ao calcular a(s) Ajuda(s) de Custo.');
                    //}
                },

                //MAODEOBRA
                _createMaoDeObraResponse: function (e) {
                    //debugger;
                    if (this.MaoDeObraCreated == 0) {
                        this._showMessage('Adicionada Mão de Obra com sucesso.');
                        this.$.page_databound_ajax.generateRequest();

                        this.$.maoDeObraDate.value = "";
                        this.$.maoDeObraProjetoNo.value = "";
                        this.$.maoDeObraCodigoTipoTrabalho.value = "";
                        this.$.maoDeObraHoraInicio.value = "";
                        this.$.maoDeObraHorarioAlmoco.value = "";
                        this.$.maoDeObraHoraFim.value = "";
                        this.$.maoDeObraHorarioJantar.value = "";
                    }
                    else {
                        if (this.MaoDeObraHoraInicioFim == 1 | this.MaoDeObraHoraInicioFim == 2) {
                            this._showErrorMessage('Horário de trabalho não pode cair dentro do intervalo da Hora de Almoço.');
                        }

                        if (this.MaoDeObraHoraInicioFim == 3 | this.MaoDeObraHoraInicioFim == 4) {
                            this._showErrorMessage('Horário de trabalho não pode cair dentro do intervalo da Hora de Jantar.');
                        }

                        if (this.MaoDeObraHoraInicioFim == 5) {
                            this._showErrorMessage('A Hora de Início tem que ser inferior á Hora de Fim.');
                        }
                        if (this.MaoDeObraCreated == 99) {
                            this._showErrorMessage('Ocorreu um erro na criação da Mão de Obra.');
                        }
                    }
                },

                _deleteMaoDeObraResponse: function (e) {
                    //debugger;
                    var self = this;

                    setTimeout(function () {
                        bootbox.hideAll();
                    }, 0);

                    if (this.MaoDeObraDeleted) {
                        this._showMessage('Mão de Obra removida com sucesso.');
                        this.$.page_databound_ajax.generateRequest();
                    }
                    else {
                        this._showErrorMessage('Ocorreu um erro ao eliminar Mão de Obra.');
                    }
                },

                _updateMaoDeObraResponse: function (e) {
                    //debugger;
                    if (this.MaoDeObraUpdated == 0) {
                        this._showMessage('Mão de Obra(s) actualizada(s) com sucesso.');
                        this.$.page_databound_ajax.generateRequest();
                    }
                    else {
                        if (this.MaoDeObraUpdated == 1 | this.MaoDeObraUpdated == 2) {
                            this._showErrorMessage('Horário de trabalho não pode cair dentro do intervalo da Hora de Almoço.');
                        }

                        if (this.MaoDeObraUpdated == 3 | this.MaoDeObraUpdated == 4) {
                            this._showErrorMessage('Horário de trabalho não pode cair dentro do intervalo da Hora de Jantar.');
                        }

                        if (this.MaoDeObraUpdated == 5) {
                            this._showErrorMessage('A Hora de Início tem que ser inferior á Hora de Fim.');
                        }
                        if (this.MaoDeObraUpdated == 99) {
                            this._showErrorMessage('Ocorreu um erro ao actualizar a(s) Mão de Obra(s).');
                        }
                    }
                },

                _updateLinhaMaoDeObraResponse: function (e) {
                    //debugger;
                    if (this.LinhaMaoDeObraUpdated == 0) {
                        this._showMessage('Mão de Obra atualizada com sucesso.');
                    }
                    else {
                        if (this.LinhaMaoDeObraUpdated == 1 | this.LinhaMaoDeObraUpdated == 2) {
                            this._showErrorMessage('Horário de trabalho não pode cair dentro do intervalo da Hora de Almoço.');
                        }

                        if (this.LinhaMaoDeObraUpdated == 3 | this.LinhaMaoDeObraUpdated == 4) {
                            this._showErrorMessage('Horário de trabalho não pode cair dentro do intervalo da Hora de Jantar.');
                        }

                        if (this.LinhaMaoDeObraUpdated == 5) {
                            this._showErrorMessage('A Hora de Início tem que ser inferior á Hora de Fim.');
                        }
                        if (this.LinhaMaoDeObraUpdated == 6) {
                            this._showErrorMessage('A Data-Hora de Início tem que ser superior ou igual á Data-Hora de Início do cabeçalho.');
                        }
                        if (this.LinhaMaoDeObraUpdated == 7) {
                            this._showErrorMessage('A Data-Hora de Início tem que ser inferior ou igual á Data-Hora de Fim do cabeçalho.');
                        }
                        if (this.LinhaMaoDeObraUpdated == 8) {
                            this._showErrorMessage('A Data-Hora de Fim tem que ser superior á Data-Hora de Início do cabeçalho.');
                        }
                        if (this.LinhaMaoDeObraUpdated == 9) {
                            this._showErrorMessage('A Data-Hora de Fim tem que ser inferior ou igual á Data-Hora de Fim do cabeçalho.');
                        }
                        if (this.LinhaMaoDeObraUpdated == 99) {
                            this._showErrorMessage('Ocorreu um erro ao actualizar a(s) Mão de Obra(s).');
                        }
                    }
                    this.$.page_databound_ajax.generateRequest();
                },

                _MaoDeObraHoraInicioFimResponse: function (e) {
                    //debugger;
                    if (this.MaoDeObraHoraInicioFim == 1 | this.MaoDeObraHoraInicioFim == 2) {
                        this._showErrorMessage('Horário de trabalho não pode cair dentro do intervalo da Hora de Almoço.');
                    }

                    if (this.MaoDeObraHoraInicioFim == 3 | this.MaoDeObraHoraInicioFim == 4) {
                        this._showErrorMessage('Horário de trabalho não pode cair dentro do intervalo da Hora de Jantar.');
                    }

                    if (this.MaoDeObraHoraInicioFim == 5) {
                        this._showErrorMessage('A Hora de Início tem que ser inferior á Hora de Fim.');
                    }
                },


                //PRESENCA
                _createPresencaResponse: function (e) {
                    //debugger;
                    if (this.PresencaCreated == 0) {
                        this._showMessage('Presença adicionada Presença com sucesso.');

                        this.$.presencaDataTexto.value = "";
                        this.$.presencaHora1Entrada.value = "";
                        this.$.presencaHora1Saida.value = "";
                        this.$.presencaHora2Entrada.value = "";
                        this.$.presencaHora2Saida.value = "";
                        this.$.presencaObservacoes.value = "";
                    }
                    else {
                        if (this.PresencaCreated == 1) {
                            this._showErrorMessage('Não pode ter mais que uma presença para o mesmo dia.');
                        }
                        if (this.PresencaCreated == 2) {
                            this._showErrorMessage('A hora da 1ª Entrada tem que ser superior à Hora de Inicio e inferior à Hora de Fim no Cabeçalho.');
                        }
                        if (this.PresencaCreated == 3) {
                            this._showErrorMessage('A hora da 1ª Saída tem que ser superior à Hora de Inicio e inferior à Hora de Fim no Cabeçalho.');
                        }
                        if (this.PresencaCreated == 4) {
                            this._showErrorMessage('A hora da 2ª Entrada tem que ser superior à Hora de Inicio e inferior à Hora de Fim no Cabeçalho.');
                        }
                        if (this.PresencaCreated == 5) {
                            this._showErrorMessage('A hora da 2ª Saída tem que ser superior à Hora de Inicio e inferior à Hora de Fim no Cabeçalho.');
                        }
                        if (this.PresencaCreated == 6) {
                            this._showErrorMessage('A hora da 1ª Entrada não está correta em relação ás outras horas.');
                        }
                        if (this.PresencaCreated == 7) {
                            this._showErrorMessage('A hora da 1ª Saída não está correta em relação ás outras horas.');
                        }
                        if (this.PresencaCreated == 8) {
                            this._showErrorMessage('A hora da 2ª Entrada não está correta em relação ás outras horas.');
                        }
                        if (this.PresencaCreated == 9) {
                            this._showErrorMessage('A hora da 2ª Saída não está correta em relação ás outras horas.');
                        }
                        if (this.PresencaCreated == 99) {
                            this._showErrorMessage('Ocorreu um erro ao actualiazar a Presença.');
                        }
                    }
                    this.$.page_databound_ajax.generateRequest();
                },

                _deletePresencaResponse: function (e) {
                    //debugger;
                    var self = this;

                    setTimeout(function () {
                        bootbox.hideAll();
                    }, 0);

                    if (this.PresencaDeleted) {
                        this._showMessage('Presença removida com sucesso.');
                        this.$.page_databound_ajax.generateRequest();
                    }
                    else {
                        this._showErrorMessage('Ocorreu um erro ao eliminar a Presença.');
                    }
                },

                _updatePresencaResponse: function (e) {
                    //debugger;
                    if (this.PresencaUpdated) {
                        this._showMessage('Presença(s) actualizada(s) com sucesso.');
                        this.$.page_databound_ajax.generateRequest();
                    }
                    else {
                        this._showErrorMessage('Ocorreu um erro ao actualizar a(s) Presença(s).');
                    }
                },

                _updateLinhaPresencaResponse: function (e) {
                    //debugger;
                    if (this.LinhaPresencaUpdated == 0) {
                        this._showMessage('Presença atualizada com sucesso.');
                    }
                    else {
                        if (this.LinhaPresencaUpdated == 1) {
                            this._showErrorMessage('Não foi possivel atualizar a Presença.');
                        }
                        if (this.LinhaPresencaUpdated == 2) {
                            this._showErrorMessage('A hora da 1ª Entrada tem que ser superior à Hora de Inicio e inferior à Hora de Fim no Cabeçalho.');
                        }
                        if (this.LinhaPresencaUpdated == 3) {
                            this._showErrorMessage('A hora da 1ª Saída tem que ser superior à Hora de Inicio e inferior à Hora de Fim no Cabeçalho.');
                        }
                        if (this.LinhaPresencaUpdated == 4) {
                            this._showErrorMessage('A hora da 2ª Entrada tem que ser superior à Hora de Inicio e inferior à Hora de Fim no Cabeçalho.');
                        }
                        if (this.LinhaPresencaUpdated == 5) {
                            this._showErrorMessage('A hora da 2ª Saída tem que ser superior à Hora de Inicio e inferior à Hora de Fim no Cabeçalho.');
                        }
                        if (this.LinhaPresencaUpdated == 6) {
                            this._showErrorMessage('A hora da 1ª Entrada não está correta em relação ás outras horas.');
                        }
                        if (this.LinhaPresencaUpdated == 7) {
                            this._showErrorMessage('A hora da 1ª Saída não está correta em relação ás outras horas.');
                        }
                        if (this.LinhaPresencaUpdated == 8) {
                            this._showErrorMessage('A hora da 2ª Entrada não está correta em relação ás outras horas.');
                        }
                        if (this.LinhaPresencaUpdated == 9) {
                            this._showErrorMessage('A hora da 2ª Saída não está correta em relação ás outras horas.');
                        }
                        if (this.LinhaPresencaUpdated == 99) {
                            this._showErrorMessage('Ocorreu um erro ao actualiazar a Presença.');
                        }
                    }
                    this.$.page_databound_ajax.generateRequest();
                },

                //EMPREGADO FUNÇÕES
                _codeChange: function (e) {
                    //debugger;
                    //this.$.getEmpoyeeNAV_ajax.body = JSON.stringify(e.detail.value, this.$.folhaDeHorasNo.value);
                    if (e.detail.value != "") {
                        this.data.empregadoNo = e.detail.value;
                        this.$.getEmpoyeeNAV_ajax.body = JSON.stringify(this.data);
                        this.$.getEmpoyeeNAV_ajax.generateRequest();
                    };
                },

                _getEmpoyeeNAVResponse: function (e) {
                    //debugger;

                    this.$.codigoRegiao.value = this.getEmpoyeeNAV.codigoRegiao;
                    this.$.codigoAreaFuncional.value = this.getEmpoyeeNAV.codigoAreaFuncional;
                    this.$.codigoCentroResponsabilidade.value = this.getEmpoyeeNAV.codigoCentroResponsabilidade;

                    if (this.getEmpoyeeNAV.empregadoNome != null) {
                        this.$.empregadoNome.value = this.getEmpoyeeNAV.empregadoNome;


                        if (this.getEmpoyeeNAV.validadores == null | this.getEmpoyeeNAV.validadores == "") {
                            this.$.validadores.value = "";
                            this._showErrorMessage('O Empregado não tem validadore(s).');
                        }
                        else {
                            this.$.validadores.value = this.getEmpoyeeNAV.validadores;
                        }

                        if (this.getEmpoyeeNAV.integradoresEmRH == null | this.getEmpoyeeNAV.integradoresEmRH == "") {
                            this.$.integradoresEmRH.value = "";
                            this._showErrorMessage('O Empregado não tem Integradore(s) Aj Custo.');
                        }
                        else {
                            this.$.integradoresEmRH.value = this.getEmpoyeeNAV.integradoresEmRH;
                        }

                        if (this.getEmpoyeeNAV.integradoresEmRHKM == null | this.getEmpoyeeNAV.integradoresEmRHKM == "") {
                            this.$.integradoresEmRHKM.value = "";
                            this._showErrorMessage('O Empregado não tem Integradore(s) km RH.');
                        }
                        else {
                            this.$.integradoresEmRHKM.value = this.getEmpoyeeNAV.integradoresEmRHKM;
                        }
                    }
                },

                //DATA INICIO
                _DataInicio: function (e) {
                    //debugger;
                    var self = this;
                    if (this.$.dataPartidaTexto.value != null) {
                        this.$.percursoDataViagem.value = this.$.dataPartidaTexto.value;
                    }
                },

                _getAjudaCodTipoCusto: function (e) {
                    //debugger;
                    this.$.ajudaDataDespesa.value = this.$.dataPartidaTexto.value;
                    this.$.get_codtipocusto.body = JSON.stringify({ id: this.$.ajudaTipoCusto.value || 0 });
                    this.$.get_codtipocusto.generateRequest();
                    if (typeof e != 'undefined') {
                        this.$.Modelo.value = "";
                    }
                },

                _getAjudaCodTipoCustoTAB: function (e) {
                    //debugger;
                    this.$.get_codtipocustotab.body = JSON.stringify({ id: e.model.item.tabAjudaTipoCusto.id || 0 });
                    this.$.get_codtipocustotab.generateRequest();
                    if (typeof e != 'undefined') {
                        this.$.Modelo.value = "";
                    }
                },

                _setCodTipoCustoResponse: function (data) {
                    //debugger;
                    if (this.LFolhaDeHoraAjudaCodTipoCusto.length > 0) {
                        this.$.ajudaCodigoTipoCusto.disabled = false;
                    } else {
                        this.$.ajudaCodigoTipoCusto.disabled = true;
                    }
                },

                _setCodTipoCustoTabResponse: function (e) {
                    //debugger;
                    if (this.LFolhaDeHoraAjudaCodTipoCusto_TAB.length > 0) {
                        this.$.tabAjudaTipoCusto.disabled = false;
                    } else {
                        this.$.tabAjudaTipoCusto.disabled = true;
                    }
                },

                _goBack: function (e) {
                    //debugger;
                    //window.location = "../";
                    window.history.back();
                },


                _setFieldsEditability(data) {
                    //debugger;;
                    var _self = this;

                    //BOTÕES
                    if (data.terminada == true) { //TERMINADA
                        $(_self.$.btn_calcularAjudasCusto).addClass('disabled');
                        $(_self.$.btn_updateFH1).addClass('disabled');
                        $(_self.$.btn_updateFH2).addClass('disabled');
                        $(_self.$.btn_createPercurso).addClass('disabled');
                        $(_self.$.btn_createAjuda).addClass('disabled');
                        if (_self.$.integradorEmRH.value != null) {
                            $(_self.$.btn_integrarEmRH).addClass('disabled');
                        }
                        if (_self.$.integradorEmRHKM.value != null) {
                            $(_self.$.btn_integrarEmRHKM).addClass('disabled');
                        }
                    };
                    if (data.estado == 1) { //VALIDADO
                        $(_self.$.btn_calcularAjudasCusto).addClass('disabled');
                        $(_self.$.btn_validarFolhaDeHoras).addClass('disabled');
                        $(_self.$.btn_createPercurso).addClass('disabled');
                        $(_self.$.btn_createAjuda).addClass('disabled');
                        if (_self.$.integradorEmRH.value != null) {
                            $(_self.$.btn_integrarEmRH).addClass('disabled');
                        }
                        if (_self.$.integradorEmRHKM.value != null) {
                            $(_self.$.btn_integrarEmRHKM).addClass('disabled');
                        }
                    };
                    if (data.estado == 2) { //REGISTADO
                        $(_self.$.btn_calcularAjudasCusto).addClass('disabled');
                        $(_self.$.btn_validarFolhaDeHoras).addClass('disabled');
                        $(_self.$.btn_integrarEmRH).addClass('disabled');
                        $(_self.$.btn_integrarEmRHKM).addClass('disabled');
                        $(_self.$.btn_updateFH1).addClass('disabled');
                        $(_self.$.btn_createPercurso).addClass('disabled');
                        $(_self.$.btn_createAjuda).addClass('disabled');
                        $(_self.$.btn_createMaoDeObra).addClass('disabled');
                        $(_self.$.btn_createPresenca).addClass('disabled');
                        $(_self.$.btn_updateFH2).addClass('disabled');
                    };

                    //CAMPOS
                    if (data.terminada == true) { //TERMINADA
                        _self.$.projetoNo.disabled = true;
                        _self.$.empregadoNo.disabled = true;
                        _self.$.dataPartidaTexto.disabled = true;
                        _self.$.horaPartidaTexto.disabled = true;
                        _self.$.dataChegadaTexto.disabled = true;
                        _self.$.horaChegadaTexto.disabled = true;
                        _self.$.tipoDeslocacao.disabled = true;
                        _self.$.codigoTipoKms.disabled = true;
                        _self.$.matricula.disabled = true;
                        _self.$.deslocacaoForaConcelho.disabled = true;
                        _self.$.terminada.disabled = true;

                        _self.$.codigoRegiao.disabled = true;
                        _self.$.codigoAreaFuncional.disabled = true;
                        _self.$.codigoCentroResponsabilidade.disabled = true;
                        _self.$.observacoes.disabled = true;
                    };
                    if (data.estado == 1) { //VALIDADO
                        _self.$.projetoNo.disabled = true;
                        _self.$.empregadoNo.disabled = true;
                        _self.$.dataPartidaTexto.disabled = true;
                        _self.$.horaPartidaTexto.disabled = true;
                        _self.$.dataChegadaTexto.disabled = true;
                        _self.$.horaChegadaTexto.disabled = true;
                        _self.$.tipoDeslocacao.disabled = true;
                        _self.$.codigoTipoKms.disabled = true;
                        _self.$.matricula.disabled = true;
                        _self.$.deslocacaoForaConcelho.disabled = true;
                        _self.$.terminada.disabled = true;
                        _self.$.percursoOrigem.disabled = true;
                        _self.$.percursoDestino.disabled = true;
                        _self.$.percursoDataViagem.disabled = true;
                        _self.$.ajudaTipoCusto.disabled = true;
                        _self.$.ajudaCodigoTipoCusto.disabled = true;
                        _self.$.ajudaQuantidade.disabled = true;
                        _self.$.ajudaCustoUnitario.disabled = true;
                        _self.$.ajudaPrecoUnitario.disabled = true;
                        _self.$.ajudaDataDespesa.disabled = true;
                        _self.$.ajudaJustificacao.disabled = true;
                        _self.$.maoDeObraDate.disabled = true;
                        _self.$.maoDeObraProjetoNo.disabled = true;
                        _self.$.maoDeObraCodigoTipoTrabalho.disabled = true;
                        _self.$.maoDeObraHoraInicio.disabled = true;
                        _self.$.maoDeObraHorarioAlmoco.disabled = true;
                        _self.$.maoDeObraHoraFim.disabled = true;
                        _self.$.maoDeObraHorarioJantar.disabled = true;
                        _self.$.presencaDataTexto.disabled = true;
                        _self.$.presencaHora1Entrada.disabled = true;
                        _self.$.presencaHora1Saida.disabled = true;
                        _self.$.presencaHora2Entrada.disabled = true;
                        _self.$.presencaHora2Saida.disabled = true;
                        _self.$.presencaObservacoes.disabled = true;
                        _self.$.codigoRegiao.disabled = true;
                        _self.$.codigoAreaFuncional.disabled = true;
                        _self.$.codigoCentroResponsabilidade.disabled = true;
                        _self.$.observacoes.disabled = true;

                        _self.$.percursoOrigem.disabled = true;
                        _self.$.percursoDestino.disabled = true;
                        _self.$.percursoDataViagem.disabled = true;
                        _self.$.ajudaTipoCusto.disabled = true;
                        _self.$.ajudaCodigoTipoCusto.disabled = true;
                        _self.$.ajudaQuantidade.disabled = true;
                        _self.$.ajudaCustoUnitario.disabled = true;
                        _self.$.ajudaPrecoUnitario.disabled = true;
                        _self.$.ajudaDataDespesa.disabled = true;
                        _self.$.ajudaJustificacao.disabled = true;
                    };
                    if (data.estado == 2) { //REGISTADO
                        _self.$.projetoNo.disabled = true;
                        _self.$.empregadoNo.disabled = true;
                        _self.$.dataPartidaTexto.disabled = true;
                        _self.$.horaPartidaTexto.disabled = true;
                        _self.$.dataChegadaTexto.disabled = true;
                        _self.$.horaChegadaTexto.disabled = true;
                        _self.$.tipoDeslocacao.disabled = true;
                        _self.$.codigoTipoKms.disabled = true;
                        _self.$.matricula.disabled = true;
                        _self.$.deslocacaoForaConcelho.disabled = true;
                        _self.$.terminada.disabled = true;
                        _self.$.percursoOrigem.disabled = true;
                        _self.$.percursoDestino.disabled = true;
                        _self.$.percursoDataViagem.disabled = true;
                        _self.$.ajudaTipoCusto.disabled = true;
                        _self.$.ajudaCodigoTipoCusto.disabled = true;
                        _self.$.ajudaQuantidade.disabled = true;
                        _self.$.ajudaCustoUnitario.disabled = true;
                        _self.$.ajudaPrecoUnitario.disabled = true;
                        _self.$.ajudaDataDespesa.disabled = true;
                        _self.$.ajudaJustificacao.disabled = true;
                        _self.$.maoDeObraDate.disabled = true;
                        _self.$.maoDeObraProjetoNo.disabled = true;
                        _self.$.maoDeObraCodigoTipoTrabalho.disabled = true;
                        _self.$.maoDeObraHoraInicio.disabled = true;
                        _self.$.maoDeObraHorarioAlmoco.disabled = true;
                        _self.$.maoDeObraHoraFim.disabled = true;
                        _self.$.maoDeObraHorarioJantar.disabled = true;
                        _self.$.presencaDataTexto.disabled = true;
                        _self.$.presencaHora1Entrada.disabled = true;
                        _self.$.presencaHora1Saida.disabled = true;
                        _self.$.presencaHora2Entrada.disabled = true;
                        _self.$.presencaHora2Saida.disabled = true;
                        _self.$.presencaObservacoes.disabled = true;
                        _self.$.codigoRegiao.disabled = true;
                        _self.$.codigoAreaFuncional.disabled = true;
                        _self.$.codigoCentroResponsabilidade.disabled = true;
                        _self.$.observacoes.disabled = true;
                    };

                    //TABELAS
                    if (data.terminada == true) { //TERMINADA
                        $(_self.$.tabPercurso).addClass('disabled');
                        $(_self.$.tabAjuda).addClass('disabled');
                    }
                    if (data.estado == 1) { //VALIDADO
                        $(_self.$.tabPercurso).addClass('disabled');
                        $(_self.$.tabAjuda).addClass('disabled');
                    };
                    if (data.estado == 2) { //REGISTADO
                        $(_self.$.tabPercurso).addClass('disabled');
                        $(_self.$.tabAjuda).addClass('disabled');
                        $(_self.$.tabMaoDeObra).addClass('disabled');
                        $(_self.$.tabPresenca).addClass('disabled');
                    };
                },

                _printFH: function () {
                    //debugger;

                    if (this._reportserverurl != undefined) {
                        this.$.rptContainer.src = this._reportserverurl + "FolhaHora&FH=" + this._folhadehoraid + "&Utilizador=" + this._userlogin;
                        this.$.rptDialog.open();
                    }
                    else {
                        this._showErrorMessage("Não é possivel imprimir. Não foi definido o servidor de relatórios.");
                    }
                },

                _closeRptDialog: function () {
                    this.$.rptContainer.src = "about:blank";
                    this.$.rptDialog.close();
                },

                //Helpers
                _executeRequest: function (url, data) {
                    //debugger;

                    this.$.page_databound_ajax.url = url;
                    this.$.page_databound_ajax.body = JSON.stringify(data);
                    this.$.page_databound_ajax.generateRequest();
                }
            });
        });
    </script>
</dom-module>